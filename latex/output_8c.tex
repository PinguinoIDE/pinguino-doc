\hypertarget{output_8c}{\section{/dvpt/pinguino/git/pinguino-\/libraries/p8/pinguino/core/output.c File Reference}
\label{output_8c}\index{/dvpt/pinguino/git/pinguino-\/libraries/p8/pinguino/core/output.\-c@{/dvpt/pinguino/git/pinguino-\/libraries/p8/pinguino/core/output.\-c}}
}
{\ttfamily \#include $<$serial.\-c$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{output_8c_a353c8d0844ff00c179b2bed7fb152b04}{\-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-}
\item 
\#define \hyperlink{output_8c_aae3f0b4211ba45d265973d40ccbb5fd1}{S\-E\-R\-I\-A\-L}~1
\item 
\#define \hyperlink{output_8c_ab54ca40cdae51b46ff44e42632824722}{S\-E\-R\-I\-A\-L1}~1
\item 
\#define \hyperlink{output_8c_a3b0844690e0baf19f1e211e271a2d520}{S\-E\-R\-I\-A\-L2}~2
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int $\ast$ \hyperlink{output_8c_a738d5d6770deaeaf7cf5e5381d296b21}{sbrk} (int nbbytes)
\item 
int \hyperlink{output_8c_adc50a6219f99993c79b0fa6fbd467eb4}{open} (const char $\ast$name, int flags, int mode)
\item 
int \hyperlink{output_8c_aef549d17ba94cf1e252df77360f127de}{close} (int file)
\item 
int \hyperlink{output_8c_a5adffd2b7a4629e7f2a9c2090f2b7ad1}{fstat} (int file, void $\ast$st)
\item 
int \hyperlink{output_8c_a2cf4c4b087df7b15fb2aa7401ddfc010}{isatty} (int file)
\item 
int \hyperlink{output_8c_a100b00771a8b06bfc443efb32da0f9d9}{lseek} (int file, int ptr, int \hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir})
\item 
int \hyperlink{output_8c_aa0c5d610f8b61891a7cf5fca2671b6f9}{read} (int file, char $\ast$ptr, int len)
\item 
int \hyperlink{output_8c_ad0f87c9a81020afdf227817ffab35de3}{write} (char file, char $\ast$ptr, int len)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int $\ast$ \hyperlink{output_8c_a6f71a3b83109b479cf6ac885e4682112}{heap\-\_\-ptr}
\item 
int \hyperlink{output_8c_a346450f5203cd0c87efefd1e893782d0}{\-\_\-heap}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{output_8c_a353c8d0844ff00c179b2bed7fb152b04}{\index{output.\-c@{output.\-c}!\-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-@{\-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-@{\-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-}!output.c@{output.\-c}}
\subsubsection[{\-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-\_\-\-O\-U\-T\-P\-U\-T\-\_\-\-C\-\_\-\-\_\-}}\label{output_8c_a353c8d0844ff00c179b2bed7fb152b04}


Definition at line 25 of file output.\-c.

\hypertarget{output_8c_aae3f0b4211ba45d265973d40ccbb5fd1}{\index{output.\-c@{output.\-c}!S\-E\-R\-I\-A\-L@{S\-E\-R\-I\-A\-L}}
\index{S\-E\-R\-I\-A\-L@{S\-E\-R\-I\-A\-L}!output.c@{output.\-c}}
\subsubsection[{S\-E\-R\-I\-A\-L}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-E\-R\-I\-A\-L~1}}\label{output_8c_aae3f0b4211ba45d265973d40ccbb5fd1}


Definition at line 27 of file output.\-c.

\hypertarget{output_8c_ab54ca40cdae51b46ff44e42632824722}{\index{output.\-c@{output.\-c}!S\-E\-R\-I\-A\-L1@{S\-E\-R\-I\-A\-L1}}
\index{S\-E\-R\-I\-A\-L1@{S\-E\-R\-I\-A\-L1}!output.c@{output.\-c}}
\subsubsection[{S\-E\-R\-I\-A\-L1}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-E\-R\-I\-A\-L1~1}}\label{output_8c_ab54ca40cdae51b46ff44e42632824722}


Definition at line 28 of file output.\-c.

\hypertarget{output_8c_a3b0844690e0baf19f1e211e271a2d520}{\index{output.\-c@{output.\-c}!S\-E\-R\-I\-A\-L2@{S\-E\-R\-I\-A\-L2}}
\index{S\-E\-R\-I\-A\-L2@{S\-E\-R\-I\-A\-L2}!output.c@{output.\-c}}
\subsubsection[{S\-E\-R\-I\-A\-L2}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-E\-R\-I\-A\-L2~2}}\label{output_8c_a3b0844690e0baf19f1e211e271a2d520}


Definition at line 29 of file output.\-c.



\subsection{Function Documentation}
\hypertarget{output_8c_aef549d17ba94cf1e252df77360f127de}{\index{output.\-c@{output.\-c}!close@{close}}
\index{close@{close}!output.c@{output.\-c}}
\subsubsection[{close}]{\setlength{\rightskip}{0pt plus 5cm}int close (
\begin{DoxyParamCaption}
\item[{int}]{file}
\end{DoxyParamCaption}
)}}\label{output_8c_aef549d17ba94cf1e252df77360f127de}


Definition at line 84 of file output.\-c.


\begin{DoxyCode}
85 \{
86     \textcolor{keywordflow}{return} -1;
87     \textcolor{comment}{// TODO clear interrupt for some stream}
88 \}
\end{DoxyCode}
\hypertarget{output_8c_a5adffd2b7a4629e7f2a9c2090f2b7ad1}{\index{output.\-c@{output.\-c}!fstat@{fstat}}
\index{fstat@{fstat}!output.c@{output.\-c}}
\subsubsection[{fstat}]{\setlength{\rightskip}{0pt plus 5cm}int fstat (
\begin{DoxyParamCaption}
\item[{int}]{file, }
\item[{void $\ast$}]{st}
\end{DoxyParamCaption}
)}}\label{output_8c_a5adffd2b7a4629e7f2a9c2090f2b7ad1}


Definition at line 99 of file output.\-c.


\begin{DoxyCode}
100 \{
101     \textcolor{keywordflow}{return} 0;
102 \}
\end{DoxyCode}
\hypertarget{output_8c_a2cf4c4b087df7b15fb2aa7401ddfc010}{\index{output.\-c@{output.\-c}!isatty@{isatty}}
\index{isatty@{isatty}!output.c@{output.\-c}}
\subsubsection[{isatty}]{\setlength{\rightskip}{0pt plus 5cm}int isatty (
\begin{DoxyParamCaption}
\item[{int}]{file}
\end{DoxyParamCaption}
)}}\label{output_8c_a2cf4c4b087df7b15fb2aa7401ddfc010}


Definition at line 109 of file output.\-c.


\begin{DoxyCode}
110 \{
111     \textcolor{keywordflow}{return} 1;
112 \}
\end{DoxyCode}
\hypertarget{output_8c_a100b00771a8b06bfc443efb32da0f9d9}{\index{output.\-c@{output.\-c}!lseek@{lseek}}
\index{lseek@{lseek}!output.c@{output.\-c}}
\subsubsection[{lseek}]{\setlength{\rightskip}{0pt plus 5cm}int lseek (
\begin{DoxyParamCaption}
\item[{int}]{file, }
\item[{int}]{ptr, }
\item[{int}]{dir}
\end{DoxyParamCaption}
)}}\label{output_8c_a100b00771a8b06bfc443efb32da0f9d9}


Definition at line 119 of file output.\-c.


\begin{DoxyCode}
120 \{
121     \textcolor{keywordflow}{return} 0;
122 \}
\end{DoxyCode}
\hypertarget{output_8c_adc50a6219f99993c79b0fa6fbd467eb4}{\index{output.\-c@{output.\-c}!open@{open}}
\index{open@{open}!output.c@{output.\-c}}
\subsubsection[{open}]{\setlength{\rightskip}{0pt plus 5cm}int open (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name, }
\item[{int}]{flags, }
\item[{int}]{mode}
\end{DoxyParamCaption}
)}}\label{output_8c_adc50a6219f99993c79b0fa6fbd467eb4}


Definition at line 60 of file output.\-c.



References Serial\-Configure(), U\-A\-R\-T1, U\-A\-R\-T2, U\-A\-R\-T\-\_\-\-E\-N\-A\-B\-L\-E, and U\-A\-R\-T\-\_\-\-R\-X\-\_\-\-T\-X\-\_\-\-E\-N\-A\-B\-L\-E\-D.


\begin{DoxyCode}
61 \{   
62     \textcolor{keywordflow}{if} (!strcmp(name,\textcolor{stringliteral}{"SERIAL1"})) 
63     \{
64         \hyperlink{p32_2include_2pinguino_2core_2serial_8c_a0f213d0381fb0d45af9bc0c6d0aa2127}{SerialConfigure}(\hyperlink{p32_2include_2pinguino_2core_2serial_8c_a8d69bf04d07af4fbbab5a8bd291f65ff}{UART1}, \hyperlink{p32_2include_2pinguino_2core_2serial_8c_aaaf6c77e3b8fec12ad625225a08c4f28}{UART\_ENABLE},  
      \hyperlink{p32_2include_2pinguino_2core_2serial_8c_a79e41610f669265a690114ac881f8a89}{UART\_RX\_TX\_ENABLED},   9600);
65         \textcolor{keywordflow}{return}(1);
66     \}
67 
68     \textcolor{keywordflow}{if} (!strcmp(name,\textcolor{stringliteral}{"SERIAL2"})) 
69     \{
70         \hyperlink{p32_2include_2pinguino_2core_2serial_8c_a0f213d0381fb0d45af9bc0c6d0aa2127}{SerialConfigure}(\hyperlink{p32_2include_2pinguino_2core_2serial_8c_a7f6bd6eb89ae2eeae97af4207ebe3cde}{UART2}, \hyperlink{p32_2include_2pinguino_2core_2serial_8c_aaaf6c77e3b8fec12ad625225a08c4f28}{UART\_ENABLE},  
      \hyperlink{p32_2include_2pinguino_2core_2serial_8c_a79e41610f669265a690114ac881f8a89}{UART\_RX\_TX\_ENABLED},   9600);
71         \textcolor{keywordflow}{return}(2);
72     \}
73     
74 \textcolor{comment}{// TODO LCD, SPI etc.....}
75 \textcolor{comment}{// TODO define a flag to know if the stream is opened}
76     
77     \textcolor{keywordflow}{return} -1;
78 \}
\end{DoxyCode}
\hypertarget{output_8c_aa0c5d610f8b61891a7cf5fca2671b6f9}{\index{output.\-c@{output.\-c}!read@{read}}
\index{read@{read}!output.c@{output.\-c}}
\subsubsection[{read}]{\setlength{\rightskip}{0pt plus 5cm}int read (
\begin{DoxyParamCaption}
\item[{int}]{file, }
\item[{char $\ast$}]{ptr, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}}\label{output_8c_aa0c5d610f8b61891a7cf5fca2671b6f9}


Definition at line 129 of file output.\-c.



References Serial\-Read(), and U\-A\-R\-T1.



Referenced by I2\-C\-\_\-request\-From().


\begin{DoxyCode}
130 \{
131     \textcolor{keywordtype}{int} caractere=0;
132     \textcolor{keywordtype}{int} nbchar=0;
133     
134     \textcolor{keywordflow}{switch} (file)
135     \{
136         \textcolor{keywordflow}{case} 0:
137             \textcolor{keywordflow}{while} (caractere!=-1)       \textcolor{comment}{// stdin}
138             \{
139                 caractere=\hyperlink{p32_2include_2pinguino_2core_2serial_8c_a46b4e3730df878a192c4e1aeb3a4325d}{SerialRead}(\hyperlink{p32_2include_2pinguino_2core_2serial_8c_a8d69bf04d07af4fbbab5a8bd291f65ff}{UART1});
140                 \textcolor{keywordflow}{if} (caractere!=-1)
141                 \{
142                     *ptr++=caractere;
143                     nbchar++;
144                 \}
145             \}
146             \textcolor{keywordflow}{if} (nbchar!=0)
147                 \textcolor{keywordflow}{return}(nbchar);
148             \textcolor{keywordflow}{else}
149                 \textcolor{keywordflow}{return}(-1);
150             \textcolor{keywordflow}{break};
151     \}
152 
153     \textcolor{keywordflow}{return} -1;
154 \}
\end{DoxyCode}
\hypertarget{output_8c_a738d5d6770deaeaf7cf5e5381d296b21}{\index{output.\-c@{output.\-c}!sbrk@{sbrk}}
\index{sbrk@{sbrk}!output.c@{output.\-c}}
\subsubsection[{sbrk}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ sbrk (
\begin{DoxyParamCaption}
\item[{int}]{nbbytes}
\end{DoxyParamCaption}
)}}\label{output_8c_a738d5d6770deaeaf7cf5e5381d296b21}


Definition at line 44 of file output.\-c.



References \-\_\-heap, and heap\-\_\-ptr.


\begin{DoxyCode}
45 \{
46     \textcolor{keywordtype}{int} *base;
47     
48     \textcolor{keywordflow}{if} (!\hyperlink{output_8c_a6f71a3b83109b479cf6ac885e4682112}{heap\_ptr})
49         \hyperlink{output_8c_a6f71a3b83109b479cf6ac885e4682112}{heap\_ptr}=(\textcolor{keywordtype}{int} *)&\hyperlink{output_8c_a346450f5203cd0c87efefd1e893782d0}{\_heap};    \textcolor{comment}{// \_heap is defined in the linker script}
50     base=\hyperlink{output_8c_a6f71a3b83109b479cf6ac885e4682112}{heap\_ptr};                  \textcolor{comment}{// on Pinguino32 heap is 8192 bytes }
51     \hyperlink{output_8c_a6f71a3b83109b479cf6ac885e4682112}{heap\_ptr} += nbbytes;
52     \textcolor{keywordflow}{return} base;
53 \}
\end{DoxyCode}
\hypertarget{output_8c_ad0f87c9a81020afdf227817ffab35de3}{\index{output.\-c@{output.\-c}!write@{write}}
\index{write@{write}!output.c@{output.\-c}}
\subsubsection[{write}]{\setlength{\rightskip}{0pt plus 5cm}int write (
\begin{DoxyParamCaption}
\item[{char}]{file, }
\item[{char $\ast$}]{ptr, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}}\label{output_8c_ad0f87c9a81020afdf227817ffab35de3}


Definition at line 161 of file output.\-c.



References Serial\-U\-A\-R\-T1\-Write\-Char(), and Serial\-U\-A\-R\-T2\-Write\-Char().


\begin{DoxyCode}
162 \{
163     \textcolor{keywordtype}{int} todo;
164     \textcolor{keywordflow}{switch} (file)
165     \{
166         \textcolor{keywordflow}{case} 1:
167             \textcolor{keywordflow}{for} (todo = 0; todo < len; todo++)
168                 \hyperlink{p32_2include_2pinguino_2core_2serial_8c_afd0e9a058cc758040a39e4df542b7726}{SerialUART1WriteChar}(*ptr++);   \textcolor{comment}{// stdout}
169             \textcolor{keywordflow}{return} len;
170             \textcolor{keywordflow}{break};
171         \textcolor{keywordflow}{case} 2:
172             \textcolor{keywordflow}{for} (todo = 0; todo < len; todo++)
173                 \hyperlink{p32_2include_2pinguino_2core_2serial_8c_aa7354910d04ba38409e1a80b22d6f5a2}{SerialUART2WriteChar}(*ptr++);   \textcolor{comment}{// stdout}
174             \textcolor{keywordflow}{return} len;
175             \textcolor{keywordflow}{break};
176         \textcolor{keywordflow}{default}:
177             \textcolor{keywordflow}{return}(-1);
178             \textcolor{keywordflow}{break};  
179     \}
180     
181     \textcolor{keywordflow}{return} -1;
182 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{output_8c_a346450f5203cd0c87efefd1e893782d0}{\index{output.\-c@{output.\-c}!\-\_\-heap@{\-\_\-heap}}
\index{\-\_\-heap@{\-\_\-heap}!output.c@{output.\-c}}
\subsubsection[{\-\_\-heap}]{\setlength{\rightskip}{0pt plus 5cm}int \-\_\-heap}}\label{output_8c_a346450f5203cd0c87efefd1e893782d0}


Referenced by sbrk().

\hypertarget{output_8c_a6f71a3b83109b479cf6ac885e4682112}{\index{output.\-c@{output.\-c}!heap\-\_\-ptr@{heap\-\_\-ptr}}
\index{heap\-\_\-ptr@{heap\-\_\-ptr}!output.c@{output.\-c}}
\subsubsection[{heap\-\_\-ptr}]{\setlength{\rightskip}{0pt plus 5cm}int$\ast$ heap\-\_\-ptr}}\label{output_8c_a6f71a3b83109b479cf6ac885e4682112}


Definition at line 41 of file output.\-c.



Referenced by sbrk().

