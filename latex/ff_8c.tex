\hypertarget{ff_8c}{\section{/dvpt/pinguino/git/pinguino-\/libraries/p32/include/pinguino/libraries/sd/ff.c File Reference}
\label{ff_8c}\index{/dvpt/pinguino/git/pinguino-\/libraries/p32/include/pinguino/libraries/sd/ff.\-c@{/dvpt/pinguino/git/pinguino-\/libraries/p32/include/pinguino/libraries/sd/ff.\-c}}
}
{\ttfamily \#include \char`\"{}ff.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}diskio.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{S\-S}(fs)~512\-U			/$\ast$ Fixed sector size $\ast$/
\item 
\#define \hyperlink{ff_8c_a458e336ac53f8249ed02d844469b7076}{E\-N\-T\-E\-R\-\_\-\-F\-F}(fs)
\item 
\#define \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{L\-E\-A\-V\-E\-\_\-\-F\-F}(fs, \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res})~return \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res}
\item 
\#define \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{A\-B\-O\-R\-T}(fs, \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res})~\{ fp-\/$>$flag $\vert$= \hyperlink{ff_8h_ad3b47fe8126573b17752a9a242b76b9a}{F\-A\-\_\-\-\_\-\-E\-R\-R\-O\-R}; \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{L\-E\-A\-V\-E\-\_\-\-F\-F}(fs, \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res}); \}
\item 
\#define \hyperlink{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{L\-D\-\_\-\-C\-L\-U\-S\-T}(\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir})~(((\hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D})\hyperlink{ff_8h_a398519bb08da6457e62567d1f0b567e3}{L\-D\-\_\-\-W\-O\-R\-D}(\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir}+\hyperlink{ff_8c_a0bc29c3f09e1e9c40c414f7d50d7905c}{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I})$<$$<$16) $\vert$ \hyperlink{ff_8h_a398519bb08da6457e62567d1f0b567e3}{L\-D\-\_\-\-W\-O\-R\-D}(\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir}+\hyperlink{ff_8c_aebe0e913bff75a89d38dbcb04baf5dff}{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}))
\item 
\#define \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{S\-T\-\_\-\-C\-L\-U\-S\-T}(\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir}, cl)~\{\hyperlink{ff_8h_a95ceb4c25b216e71baa7102939edfd0d}{S\-T\-\_\-\-W\-O\-R\-D}(\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir}+\hyperlink{ff_8c_aebe0e913bff75a89d38dbcb04baf5dff}{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}, cl); \hyperlink{ff_8h_a95ceb4c25b216e71baa7102939edfd0d}{S\-T\-\_\-\-W\-O\-R\-D}(\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir}+\hyperlink{ff_8c_a0bc29c3f09e1e9c40c414f7d50d7905c}{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I}, (\hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D})cl$>$$>$16);\}
\item 
\#define \hyperlink{ff_8c_a228bfd2cabe490c8567aaf08b8b2cc14}{\-\_\-\-D\-F1\-S}~0x81	/$\ast$ D\-B\-C 1st byte range 1 start $\ast$/
\item 
\#define \hyperlink{ff_8c_ad6ce87cea84298e562cae4f6cde3c341}{\-\_\-\-D\-F1\-E}~0x9\-F	/$\ast$ D\-B\-C 1st byte range 1 end $\ast$/
\item 
\#define \hyperlink{ff_8c_a89ebd362b483a3a465fb485c9535a3c4}{\-\_\-\-D\-F2\-S}~0x\-E0	/$\ast$ D\-B\-C 1st byte range 2 start $\ast$/
\item 
\#define \hyperlink{ff_8c_ae92fde14909ccf6bec27f051a4b88a79}{\-\_\-\-D\-F2\-E}~0x\-F\-C	/$\ast$ D\-B\-C 1st byte range 2 end $\ast$/
\item 
\#define \hyperlink{ff_8c_a866564522f9fb431919f86ae507c42ef}{\-\_\-\-D\-S1\-S}~0x40	/$\ast$ D\-B\-C 2nd byte range 1 start $\ast$/
\item 
\#define \hyperlink{ff_8c_a97cf766baca26c0ac1110df26e479c4c}{\-\_\-\-D\-S1\-E}~0x7\-E	/$\ast$ D\-B\-C 2nd byte range 1 end $\ast$/
\item 
\#define \hyperlink{ff_8c_a6fd34725741cf6dc0524df2adbbb5a94}{\-\_\-\-D\-S2\-S}~0x80	/$\ast$ D\-B\-C 2nd byte range 2 start $\ast$/
\item 
\#define \hyperlink{ff_8c_a0e747e5204b28f9c72c91cee52fde572}{\-\_\-\-D\-S2\-E}~0x\-F\-C	/$\ast$ D\-B\-C 2nd byte range 2 end $\ast$/
\item 
\#define \hyperlink{ff_8c_a89b2514198590e139dd064c5d534f302}{Is\-Upper}(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})~(((\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})$>$='\hyperlink{p32_2include_2pinguino_2core_2sound_8c_a955f504eccf76b4eb2489c0adab03121}{A}')\&\&((\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})$<$='Z'))
\item 
\#define \hyperlink{ff_8c_a4a9d454724926bd51a3aed589a97f08b}{Is\-Lower}(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})~(((\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})$>$='a')\&\&((\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})$<$='z'))
\item 
\#define \hyperlink{ff_8c_a65dee564f69f2ec27f25b67a348018b9}{Is\-Digit}(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})~(((\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})$>$='0')\&\&((\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})$<$='9'))
\item 
\#define \hyperlink{ff_8c_a58d63a832a117f179e41c7373d013dd6}{Is\-D\-B\-C\-S1}(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})~(((\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $>$= \hyperlink{ff_8c_a228bfd2cabe490c8567aaf08b8b2cc14}{\-\_\-\-D\-F1\-S} \&\& (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $<$= \hyperlink{ff_8c_ad6ce87cea84298e562cae4f6cde3c341}{\-\_\-\-D\-F1\-E}) $\vert$$\vert$ ((\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $>$= \hyperlink{ff_8c_a89ebd362b483a3a465fb485c9535a3c4}{\-\_\-\-D\-F2\-S} \&\& (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $<$= \hyperlink{ff_8c_ae92fde14909ccf6bec27f051a4b88a79}{\-\_\-\-D\-F2\-E}))
\item 
\#define \hyperlink{ff_8c_a66a3fa880af6078ef181656c1d7d8ef1}{Is\-D\-B\-C\-S2}(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c})~(((\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $>$= \hyperlink{ff_8c_a866564522f9fb431919f86ae507c42ef}{\-\_\-\-D\-S1\-S} \&\& (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $<$= \hyperlink{ff_8c_a97cf766baca26c0ac1110df26e479c4c}{\-\_\-\-D\-S1\-E}) $\vert$$\vert$ ((\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $>$= \hyperlink{ff_8c_a6fd34725741cf6dc0524df2adbbb5a94}{\-\_\-\-D\-S2\-S} \&\& (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E})(\hyperlink{p32_2include_2pinguino_2libraries_2_p_c_d8544_8c_aa0dd25f53b00986c159fb20de6894e51}{c}) $<$= \hyperlink{ff_8c_a0e747e5204b28f9c72c91cee52fde572}{\-\_\-\-D\-S2\-E}))
\item 
\#define \hyperlink{ff_8c_a06c201f90533d5b49cd039c960327968}{N\-S}~11		/$\ast$ Index of name \hyperlink{p32_2include_2pinguino_2libraries_2ledcontrol_8h_a0e245df1940369c94735090b1ea1a9d9}{status} \hyperlink{p8_2pinguino_2core_2typedef_8h_a0c8186d9b9b7880309c27230bbb5e69d}{byte} in \hyperlink{tff_8c_a4eeeb71a8aa4cf022612fc51ab25ed15}{fn}\mbox{[}$\,$\mbox{]} $\ast$/
\item 
\#define \hyperlink{ff_8c_ac92c92c3a3d6b9235ac98feeb00e565a}{N\-S\-\_\-\-L\-O\-S\-S}~0x01	/$\ast$ Out of 8.\-3 format $\ast$/
\item 
\#define \hyperlink{ff_8c_ae957b8d4065ea0b3eed822aec5368d29}{N\-S\-\_\-\-L\-F\-N}~0x02	/$\ast$ Force to create L\-F\-N entry $\ast$/
\item 
\#define \hyperlink{ff_8c_a5a0742bfc1d94f0c3baa5ede485048c4}{N\-S\-\_\-\-L\-A\-S\-T}~0x04	/$\ast$ Last segment $\ast$/
\item 
\#define \hyperlink{ff_8c_a4a0e89b504dece19e2e4b02c83782ca2}{N\-S\-\_\-\-B\-O\-D\-Y}~0x08	/$\ast$ Lower case flag (body) $\ast$/
\item 
\#define \hyperlink{ff_8c_a3b7fad0942e816fdb84d869c1f7a613e}{N\-S\-\_\-\-E\-X\-T}~0x10	/$\ast$ Lower case flag (ext) $\ast$/
\item 
\#define \hyperlink{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{N\-S\-\_\-\-D\-O\-T}~0x20	/$\ast$ Dot entry $\ast$/
\item 
\#define \hyperlink{ff_8c_aeec02d5ae07ede32b7d74155bf0fda15}{M\-I\-N\-\_\-\-F\-A\-T16}~4086	/$\ast$ Minimum number of clusters for F\-A\-T16 $\ast$/
\item 
\#define \hyperlink{ff_8c_a483625319f3e3bd5ac6502b46c375aed}{M\-I\-N\-\_\-\-F\-A\-T32}~65526	/$\ast$ Minimum number of clusters for F\-A\-T32 $\ast$/
\item 
\#define \hyperlink{ff_8c_a8f81669ee736efb2b2b49c7b0985472d}{B\-S\-\_\-jmp\-Boot}~0	/$\ast$ Jump instruction (3) $\ast$/
\item 
\#define \hyperlink{ff_8c_a02a76ada191ec2dc5f8af60ff3576da7}{B\-S\-\_\-\-O\-E\-M\-Name}~3	/$\ast$ O\-E\-M name (8) $\ast$/
\item 
\#define \hyperlink{ff_8c_a8551844b4eb4e15aecd8cc9aa3585fa2}{B\-P\-B\-\_\-\-Byts\-Per\-Sec}~11	/$\ast$ Sector size \mbox{[}\hyperlink{p8_2pinguino_2core_2typedef_8h_a0c8186d9b9b7880309c27230bbb5e69d}{byte}\mbox{]} (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_aab78e41c617a14b9540c0563d6b957fa}{B\-P\-B\-\_\-\-Sec\-Per\-Clus}~13	/$\ast$ Cluster size \mbox{[}sector\mbox{]} (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_ab3ec444c8457c9bc98aa07e846f5c1b7}{B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt}~14	/$\ast$ Size of reserved area \mbox{[}sector\mbox{]} (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_af44a1e8c89ec5502595f23496d24cbf1}{B\-P\-B\-\_\-\-Num\-F\-A\-Ts}~16	/$\ast$ Number of F\-A\-T copies (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_aaa667f14c87c45dc128f2ab208e92f98}{B\-P\-B\-\_\-\-Root\-Ent\-Cnt}~17	/$\ast$ Number of root \hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir} entries for F\-A\-T12/16 (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a4eb540eecde0f2df26fa8c7969341d68}{B\-P\-B\-\_\-\-Tot\-Sec16}~19	/$\ast$ Volume size \mbox{[}sector\mbox{]} (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a414e054c4b5ea3414ebefa3539e7e554}{B\-P\-B\-\_\-\-Media}~21	/$\ast$ Media descriptor (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a60a2f6efeb6a4c7cb2da1e5def6ca43b}{B\-P\-B\-\_\-\-F\-A\-T\-Sz16}~22	/$\ast$ F\-A\-T size \mbox{[}sector\mbox{]} (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_ac71bb771432ea532bc47713a028ebd76}{B\-P\-B\-\_\-\-Sec\-Per\-Trk}~24	/$\ast$ Track size \mbox{[}sector\mbox{]} (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a9c03603c3be34d4c5cc1b481b0bc6774}{B\-P\-B\-\_\-\-Num\-Heads}~26	/$\ast$ Number of heads (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a449d4ed5c4c8105daf29aad9488277f7}{B\-P\-B\-\_\-\-Hidd\-Sec}~28	/$\ast$ Number of special hidden sectors (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a7723a9f0da553e8879d60909d85ccb7b}{B\-P\-B\-\_\-\-Tot\-Sec32}~32	/$\ast$ Volume size \mbox{[}sector\mbox{]} (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a0c51f7393341b839dfb241c2951f3ef4}{B\-S\-\_\-\-Drv\-Num}~36	/$\ast$ Physical drive number (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a85a92e790602efef4da3a2f141611ce8}{B\-S\-\_\-\-Boot\-Sig}~38	/$\ast$ Extended boot signature (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a383a71bda500a0fb5a37f4edd785acbf}{B\-S\-\_\-\-Vol\-I\-D}~39	/$\ast$ Volume serial number (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a28498ba4b07ff90aaa9628e81fb89d32}{B\-S\-\_\-\-Vol\-Lab}~43	/$\ast$ Volume label (8) $\ast$/
\item 
\#define \hyperlink{ff_8c_a2264848692d36c1b2499c9b6a10acf75}{B\-S\-\_\-\-Fil\-Sys\-Type}~54	/$\ast$ File system type (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a6e6340030dc29e7da2e9f92e472a763d}{B\-P\-B\-\_\-\-F\-A\-T\-Sz32}~36	/$\ast$ F\-A\-T size \mbox{[}sector\mbox{]} (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a6c832cd9e28f8e4fbbd45fdc86c7ebbb}{B\-P\-B\-\_\-\-Ext\-Flags}~40	/$\ast$ Extended flags (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a1f75a149df65028e24d43727b9ffcb9d}{B\-P\-B\-\_\-\-F\-S\-Ver}~42	/$\ast$ File system version (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a7add0104bd20083d6940d616faecd45a}{B\-P\-B\-\_\-\-Root\-Clus}~44	/$\ast$ Root \hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir} first cluster (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a51c45669282b9ce9da5152231df9f3ac}{B\-P\-B\-\_\-\-F\-S\-Info}~48	/$\ast$ Offset of F\-S\-Info sector (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a383726fb93488d41866028b4f07c90e1}{B\-P\-B\-\_\-\-Bk\-Boot\-Sec}~50	/$\ast$ Offset of backup boot sectot (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_aa670c7b495f5b347c442df67b188c58f}{B\-S\-\_\-\-Drv\-Num32}~64	/$\ast$ Physical drive number (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a59c4b2f802ab4bc9319e5bd840e615b8}{B\-S\-\_\-\-Boot\-Sig32}~66	/$\ast$ Extended boot signature (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_abaa3aafdcf5e83f8cb7e2bb373b13525}{B\-S\-\_\-\-Vol\-I\-D32}~67	/$\ast$ Volume serial number (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a8241a49bce313184a58617ba1ad9e84c}{B\-S\-\_\-\-Vol\-Lab32}~71	/$\ast$ Volume label (8) $\ast$/
\item 
\#define \hyperlink{ff_8c_a8d8786452966cd0ce579f2575a54a348}{B\-S\-\_\-\-Fil\-Sys\-Type32}~82	/$\ast$ File system type (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a318e58c1966aba52b90ab98dcb649883}{F\-S\-I\-\_\-\-Lead\-Sig}~0	/$\ast$ F\-S\-I\-: Leading signature (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a3bac0e6ff5907873030db1d0a7c4ebef}{F\-S\-I\-\_\-\-Struc\-Sig}~484	/$\ast$ F\-S\-I\-: Structure signature (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_ab711e50459aba01b11c6b46a7cc1410b}{F\-S\-I\-\_\-\-Free\-\_\-\-Count}~488	/$\ast$ F\-S\-I\-: Number of free clusters (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a320700cedf300c9b418edf56e5e6b086}{F\-S\-I\-\_\-\-Nxt\-\_\-\-Free}~492	/$\ast$ F\-S\-I\-: Last allocated cluster (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_ac3f187bf0ba891551f594af6b61f3188}{M\-B\-R\-\_\-\-Table}~446	/$\ast$ M\-B\-R\-: Partition table offset (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_af133060c47366e7e557d4085d931183f}{S\-Z\-\_\-\-P\-T\-E}~16	/$\ast$ M\-B\-R\-: Size of a partition table entry $\ast$/
\item 
\#define \hyperlink{ff_8c_a74b810b3f3583c1eb54bd4305c0f261a}{B\-S\-\_\-55\-A\-A}~510	/$\ast$ Boot sector signature (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_afa89348e9fc2de82ae9e12c661366b0e}{D\-I\-R\-\_\-\-Name}~0	/$\ast$ Short file name (11) $\ast$/
\item 
\#define \hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{D\-I\-R\-\_\-\-Attr}~11	/$\ast$ Attribute (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a87ee1f701c2ab941862e3ce00c1c1e9d}{D\-I\-R\-\_\-\-N\-Tres}~12	/$\ast$ N\-T flag (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a47fb1881ea71d860db9b8280564cb4d5}{D\-I\-R\-\_\-\-Crt\-Time}~14	/$\ast$ Created time (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_acf498617bb4c7750fd738864c3c0ab5a}{D\-I\-R\-\_\-\-Crt\-Date}~16	/$\ast$ Created date (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_a0bc29c3f09e1e9c40c414f7d50d7905c}{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I}~20	/$\ast$ Higher 16-\/bit of first cluster (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}{D\-I\-R\-\_\-\-Wrt\-Time}~22	/$\ast$ Modified time (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_abed17fa699511b09cbf64961373d63a4}{D\-I\-R\-\_\-\-Wrt\-Date}~24	/$\ast$ Modified date (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_aebe0e913bff75a89d38dbcb04baf5dff}{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}~26	/$\ast$ Lower 16-\/bit of first cluster (2) $\ast$/
\item 
\#define \hyperlink{ff_8c_abfbfa613864a02a65f0bf70ead6672c7}{D\-I\-R\-\_\-\-File\-Size}~28	/$\ast$ File size (4) $\ast$/
\item 
\#define \hyperlink{ff_8c_a6c97d545619e6586b02b5d4f39f7be25}{L\-D\-I\-R\-\_\-\-Ord}~0	/$\ast$ L\-F\-N entry order and \hyperlink{ff_8c_aff828b43518c49e1d637a822879b135d}{L\-L\-E} flag (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_a28dcd75633b49e40b42a31f0cf5f5929}{L\-D\-I\-R\-\_\-\-Attr}~11	/$\ast$ L\-F\-N attribute (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_acb98a052a9be81564b56854df35480a0}{L\-D\-I\-R\-\_\-\-Type}~12	/$\ast$ L\-F\-N type (1) $\ast$/
\item 
\#define \hyperlink{ff_8c_ade1d529763d2d097a6d1410956c8a84f}{L\-D\-I\-R\-\_\-\-Chksum}~13	/$\ast$ Sum of corresponding S\-F\-N entry $\ast$/
\item 
\#define \hyperlink{ff_8c_ad73024151eff6baea94e680f7928969d}{L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}~26	/$\ast$ Filled by zero (0) $\ast$/
\item 
\#define \hyperlink{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}{S\-Z\-\_\-\-D\-I\-R}~32		/$\ast$ Size of a directory entry $\ast$/
\item 
\#define \hyperlink{ff_8c_aff828b43518c49e1d637a822879b135d}{L\-L\-E}~0x40	/$\ast$ Last long entry flag in L\-D\-I\-R\-\_\-\-Ord $\ast$/
\item 
\#define \hyperlink{ff_8c_af39f317ac33b961daaff4b8d8a7ec792}{D\-D\-E}~0x\-E5	/$\ast$ Deleted directory enrty mark in D\-I\-R\-\_\-\-Name\mbox{[}0\mbox{]} $\ast$/
\item 
\#define \hyperlink{ff_8c_a741d6fdda5989919e0bb9811da804e56}{N\-D\-D\-E}~0x05	/$\ast$ Replacement of a character collides with D\-D\-E $\ast$/
\item 
\#define \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F}~\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E} sfn\mbox{[}12\mbox{]}
\item 
\#define \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{I\-N\-I\-T\-\_\-\-B\-U\-F}(dobj)~(dobj).\hyperlink{tff_8c_a4eeeb71a8aa4cf022612fc51ab25ed15}{fn} = sfn
\item 
\#define \hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{F\-R\-E\-E\-\_\-\-B\-U\-F}()
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect} (\hyperlink{struct_f_a_t_f_s}{F\-A\-T\-F\-S} $\ast$fs, \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} clst)
\item 
\hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} \hyperlink{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{get\-\_\-fat} (\hyperlink{struct_f_a_t_f_s}{F\-A\-T\-F\-S} $\ast$fs, \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} clst)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_abd4b6b071a8d728a88727051c12bc6d7}{put\-\_\-fat} (\hyperlink{struct_f_a_t_f_s}{F\-A\-T\-F\-S} $\ast$fs, \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} clst, \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} val)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a3bb9e218b8a853db0871a0fa93a0eae6}{f\-\_\-mount} (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E} vol, \hyperlink{struct_f_a_t_f_s}{F\-A\-T\-F\-S} $\ast$fs)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_ab001edb1e8000ce84d9967e616a78ae7}{f\-\_\-open} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp, const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path, \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E} mode)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_ac4c3dcb6869ca252888eebabe39727b3}{f\-\_\-read} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp, void $\ast$buff, \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} btr, \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} $\ast$br)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_ae6a4dfae8a9e308bdb2283a37ef680f2}{f\-\_\-write} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp, const void $\ast$buff, \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} btw, \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} $\ast$bw)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_ad69c7246b122ba56a134939ee0eaf847}{f\-\_\-sync} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a53882db20ef4323dcfd1874d7733ffc3}{f\-\_\-close} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a5df0ac672ada972e89ef4b003e57f964}{f\-\_\-lseek} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp, \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} ofs)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a5a7b44d8858165d18ff5617d81244f35}{f\-\_\-opendir} (\hyperlink{struct_d_i_r}{D\-I\-R} $\ast$\hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj}, const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a329a4cbc309719043e5066031fc844c6}{f\-\_\-readdir} (\hyperlink{struct_d_i_r}{D\-I\-R} $\ast$\hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj}, \hyperlink{struct_f_i_l_i_n_f_o}{F\-I\-L\-I\-N\-F\-O} $\ast$fno)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_abe1f60daab5c7d11170c334fb832c798}{f\-\_\-stat} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path, \hyperlink{struct_f_i_l_i_n_f_o}{F\-I\-L\-I\-N\-F\-O} $\ast$fno)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a0ff39f75a87cbda9cd6ea65d83f16cec}{f\-\_\-getfree} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path, \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} $\ast$nclst, \hyperlink{struct_f_a_t_f_s}{F\-A\-T\-F\-S} $\ast$$\ast$fatfs)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a691a27b40c348f7c84b42e911636f38a}{f\-\_\-truncate} (\hyperlink{struct_f_i_l}{F\-I\-L} $\ast$fp)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a2858167fcd0bced48e9be434b3895efe}{f\-\_\-unlink} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_a4b4d38db58e89c526cfcf53200d719d0}{f\-\_\-mkdir} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_ad563f5cb82b21088065426a18fd0680a}{f\-\_\-chmod} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path, \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E} value, \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{P\-F\-\_\-\-B\-Y\-T\-E} mask)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_aafaa718d1a487e12a8f0087173dba0b9}{f\-\_\-utime} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path, const \hyperlink{struct_f_i_l_i_n_f_o}{F\-I\-L\-I\-N\-F\-O} $\ast$fno)
\item 
\hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{ff_8c_aa775b9b024acfeb3a66523cab497d142}{f\-\_\-rename} (const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path\-\_\-old, const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path\-\_\-new)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{ff_8c_ad6ce87cea84298e562cae4f6cde3c341}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-F1\-E@{\-\_\-\-D\-F1\-E}}
\index{\-\_\-\-D\-F1\-E@{\-\_\-\-D\-F1\-E}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-F1\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-F1\-E~0x9\-F	/$\ast$ D\-B\-C 1st byte range 1 end $\ast$/}}\label{ff_8c_ad6ce87cea84298e562cae4f6cde3c341}


Definition at line 156 of file ff.\-c.

\hypertarget{ff_8c_a228bfd2cabe490c8567aaf08b8b2cc14}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-F1\-S@{\-\_\-\-D\-F1\-S}}
\index{\-\_\-\-D\-F1\-S@{\-\_\-\-D\-F1\-S}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-F1\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-F1\-S~0x81	/$\ast$ D\-B\-C 1st byte range 1 start $\ast$/}}\label{ff_8c_a228bfd2cabe490c8567aaf08b8b2cc14}


Definition at line 155 of file ff.\-c.

\hypertarget{ff_8c_ae92fde14909ccf6bec27f051a4b88a79}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-F2\-E@{\-\_\-\-D\-F2\-E}}
\index{\-\_\-\-D\-F2\-E@{\-\_\-\-D\-F2\-E}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-F2\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-F2\-E~0x\-F\-C	/$\ast$ D\-B\-C 1st byte range 2 end $\ast$/}}\label{ff_8c_ae92fde14909ccf6bec27f051a4b88a79}


Definition at line 158 of file ff.\-c.

\hypertarget{ff_8c_a89ebd362b483a3a465fb485c9535a3c4}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-F2\-S@{\-\_\-\-D\-F2\-S}}
\index{\-\_\-\-D\-F2\-S@{\-\_\-\-D\-F2\-S}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-F2\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-F2\-S~0x\-E0	/$\ast$ D\-B\-C 1st byte range 2 start $\ast$/}}\label{ff_8c_a89ebd362b483a3a465fb485c9535a3c4}


Definition at line 157 of file ff.\-c.

\hypertarget{ff_8c_a97cf766baca26c0ac1110df26e479c4c}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-S1\-E@{\-\_\-\-D\-S1\-E}}
\index{\-\_\-\-D\-S1\-E@{\-\_\-\-D\-S1\-E}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-S1\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-S1\-E~0x7\-E	/$\ast$ D\-B\-C 2nd byte range 1 end $\ast$/}}\label{ff_8c_a97cf766baca26c0ac1110df26e479c4c}


Definition at line 160 of file ff.\-c.

\hypertarget{ff_8c_a866564522f9fb431919f86ae507c42ef}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-S1\-S@{\-\_\-\-D\-S1\-S}}
\index{\-\_\-\-D\-S1\-S@{\-\_\-\-D\-S1\-S}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-S1\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-S1\-S~0x40	/$\ast$ D\-B\-C 2nd byte range 1 start $\ast$/}}\label{ff_8c_a866564522f9fb431919f86ae507c42ef}


Definition at line 159 of file ff.\-c.

\hypertarget{ff_8c_a0e747e5204b28f9c72c91cee52fde572}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-S2\-E@{\-\_\-\-D\-S2\-E}}
\index{\-\_\-\-D\-S2\-E@{\-\_\-\-D\-S2\-E}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-S2\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-S2\-E~0x\-F\-C	/$\ast$ D\-B\-C 2nd byte range 2 end $\ast$/}}\label{ff_8c_a0e747e5204b28f9c72c91cee52fde572}


Definition at line 162 of file ff.\-c.

\hypertarget{ff_8c_a6fd34725741cf6dc0524df2adbbb5a94}{\index{ff.\-c@{ff.\-c}!\-\_\-\-D\-S2\-S@{\-\_\-\-D\-S2\-S}}
\index{\-\_\-\-D\-S2\-S@{\-\_\-\-D\-S2\-S}!ff.c@{ff.\-c}}
\subsubsection[{\-\_\-\-D\-S2\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-D\-S2\-S~0x80	/$\ast$ D\-B\-C 2nd byte range 2 start $\ast$/}}\label{ff_8c_a6fd34725741cf6dc0524df2adbbb5a94}


Definition at line 161 of file ff.\-c.

\hypertarget{ff_8c_a41e4c46636679236568cf50b5535847f}{\index{ff.\-c@{ff.\-c}!A\-B\-O\-R\-T@{A\-B\-O\-R\-T}}
\index{A\-B\-O\-R\-T@{A\-B\-O\-R\-T}!ff.c@{ff.\-c}}
\subsubsection[{A\-B\-O\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\-B\-O\-R\-T(
\begin{DoxyParamCaption}
\item[{}]{fs, }
\item[{}]{{\bf res}}
\end{DoxyParamCaption}
)~\{ fp-\/$>$flag $\vert$= {\bf F\-A\-\_\-\-\_\-\-E\-R\-R\-O\-R}; {\bf L\-E\-A\-V\-E\-\_\-\-F\-F}(fs, {\bf res}); \}}}\label{ff_8c_a41e4c46636679236568cf50b5535847f}


Definition at line 133 of file ff.\-c.



Referenced by f\-\_\-lseek(), f\-\_\-read(), and f\-\_\-write().

\hypertarget{ff_8c_a383726fb93488d41866028b4f07c90e1}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Bk\-Boot\-Sec@{B\-P\-B\-\_\-\-Bk\-Boot\-Sec}}
\index{B\-P\-B\-\_\-\-Bk\-Boot\-Sec@{B\-P\-B\-\_\-\-Bk\-Boot\-Sec}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Bk\-Boot\-Sec}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Bk\-Boot\-Sec~50	/$\ast$ Offset of backup boot sectot (2) $\ast$/}}\label{ff_8c_a383726fb93488d41866028b4f07c90e1}


Definition at line 416 of file ff.\-c.

\hypertarget{ff_8c_a8551844b4eb4e15aecd8cc9aa3585fa2}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Byts\-Per\-Sec@{B\-P\-B\-\_\-\-Byts\-Per\-Sec}}
\index{B\-P\-B\-\_\-\-Byts\-Per\-Sec@{B\-P\-B\-\_\-\-Byts\-Per\-Sec}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Byts\-Per\-Sec}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Byts\-Per\-Sec~11	/$\ast$ Sector size \mbox{[}{\bf byte}\mbox{]} (2) $\ast$/}}\label{ff_8c_a8551844b4eb4e15aecd8cc9aa3585fa2}


Definition at line 394 of file ff.\-c.

\hypertarget{ff_8c_a6c832cd9e28f8e4fbbd45fdc86c7ebbb}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Ext\-Flags@{B\-P\-B\-\_\-\-Ext\-Flags}}
\index{B\-P\-B\-\_\-\-Ext\-Flags@{B\-P\-B\-\_\-\-Ext\-Flags}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Ext\-Flags}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Ext\-Flags~40	/$\ast$ Extended flags (2) $\ast$/}}\label{ff_8c_a6c832cd9e28f8e4fbbd45fdc86c7ebbb}


Definition at line 412 of file ff.\-c.

\hypertarget{ff_8c_a60a2f6efeb6a4c7cb2da1e5def6ca43b}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-F\-A\-T\-Sz16@{B\-P\-B\-\_\-\-F\-A\-T\-Sz16}}
\index{B\-P\-B\-\_\-\-F\-A\-T\-Sz16@{B\-P\-B\-\_\-\-F\-A\-T\-Sz16}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-F\-A\-T\-Sz16}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-F\-A\-T\-Sz16~22	/$\ast$ F\-A\-T size \mbox{[}sector\mbox{]} (2) $\ast$/}}\label{ff_8c_a60a2f6efeb6a4c7cb2da1e5def6ca43b}


Definition at line 401 of file ff.\-c.

\hypertarget{ff_8c_a6e6340030dc29e7da2e9f92e472a763d}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-F\-A\-T\-Sz32@{B\-P\-B\-\_\-\-F\-A\-T\-Sz32}}
\index{B\-P\-B\-\_\-\-F\-A\-T\-Sz32@{B\-P\-B\-\_\-\-F\-A\-T\-Sz32}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-F\-A\-T\-Sz32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-F\-A\-T\-Sz32~36	/$\ast$ F\-A\-T size \mbox{[}sector\mbox{]} (4) $\ast$/}}\label{ff_8c_a6e6340030dc29e7da2e9f92e472a763d}


Definition at line 411 of file ff.\-c.

\hypertarget{ff_8c_a51c45669282b9ce9da5152231df9f3ac}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-F\-S\-Info@{B\-P\-B\-\_\-\-F\-S\-Info}}
\index{B\-P\-B\-\_\-\-F\-S\-Info@{B\-P\-B\-\_\-\-F\-S\-Info}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-F\-S\-Info}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-F\-S\-Info~48	/$\ast$ Offset of F\-S\-Info sector (2) $\ast$/}}\label{ff_8c_a51c45669282b9ce9da5152231df9f3ac}


Definition at line 415 of file ff.\-c.

\hypertarget{ff_8c_a1f75a149df65028e24d43727b9ffcb9d}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-F\-S\-Ver@{B\-P\-B\-\_\-\-F\-S\-Ver}}
\index{B\-P\-B\-\_\-\-F\-S\-Ver@{B\-P\-B\-\_\-\-F\-S\-Ver}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-F\-S\-Ver}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-F\-S\-Ver~42	/$\ast$ File system version (2) $\ast$/}}\label{ff_8c_a1f75a149df65028e24d43727b9ffcb9d}


Definition at line 413 of file ff.\-c.

\hypertarget{ff_8c_a449d4ed5c4c8105daf29aad9488277f7}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Hidd\-Sec@{B\-P\-B\-\_\-\-Hidd\-Sec}}
\index{B\-P\-B\-\_\-\-Hidd\-Sec@{B\-P\-B\-\_\-\-Hidd\-Sec}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Hidd\-Sec}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Hidd\-Sec~28	/$\ast$ Number of special hidden sectors (4) $\ast$/}}\label{ff_8c_a449d4ed5c4c8105daf29aad9488277f7}


Definition at line 404 of file ff.\-c.

\hypertarget{ff_8c_a414e054c4b5ea3414ebefa3539e7e554}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Media@{B\-P\-B\-\_\-\-Media}}
\index{B\-P\-B\-\_\-\-Media@{B\-P\-B\-\_\-\-Media}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Media}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Media~21	/$\ast$ Media descriptor (1) $\ast$/}}\label{ff_8c_a414e054c4b5ea3414ebefa3539e7e554}


Definition at line 400 of file ff.\-c.

\hypertarget{ff_8c_af44a1e8c89ec5502595f23496d24cbf1}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Num\-F\-A\-Ts@{B\-P\-B\-\_\-\-Num\-F\-A\-Ts}}
\index{B\-P\-B\-\_\-\-Num\-F\-A\-Ts@{B\-P\-B\-\_\-\-Num\-F\-A\-Ts}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Num\-F\-A\-Ts}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Num\-F\-A\-Ts~16	/$\ast$ Number of F\-A\-T copies (1) $\ast$/}}\label{ff_8c_af44a1e8c89ec5502595f23496d24cbf1}


Definition at line 397 of file ff.\-c.

\hypertarget{ff_8c_a9c03603c3be34d4c5cc1b481b0bc6774}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Num\-Heads@{B\-P\-B\-\_\-\-Num\-Heads}}
\index{B\-P\-B\-\_\-\-Num\-Heads@{B\-P\-B\-\_\-\-Num\-Heads}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Num\-Heads}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Num\-Heads~26	/$\ast$ Number of heads (2) $\ast$/}}\label{ff_8c_a9c03603c3be34d4c5cc1b481b0bc6774}


Definition at line 403 of file ff.\-c.

\hypertarget{ff_8c_a7add0104bd20083d6940d616faecd45a}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Root\-Clus@{B\-P\-B\-\_\-\-Root\-Clus}}
\index{B\-P\-B\-\_\-\-Root\-Clus@{B\-P\-B\-\_\-\-Root\-Clus}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Root\-Clus}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Root\-Clus~44	/$\ast$ Root {\bf dir} first cluster (4) $\ast$/}}\label{ff_8c_a7add0104bd20083d6940d616faecd45a}


Definition at line 414 of file ff.\-c.

\hypertarget{ff_8c_aaa667f14c87c45dc128f2ab208e92f98}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Root\-Ent\-Cnt@{B\-P\-B\-\_\-\-Root\-Ent\-Cnt}}
\index{B\-P\-B\-\_\-\-Root\-Ent\-Cnt@{B\-P\-B\-\_\-\-Root\-Ent\-Cnt}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Root\-Ent\-Cnt}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Root\-Ent\-Cnt~17	/$\ast$ Number of root {\bf dir} entries for F\-A\-T12/16 (2) $\ast$/}}\label{ff_8c_aaa667f14c87c45dc128f2ab208e92f98}


Definition at line 398 of file ff.\-c.

\hypertarget{ff_8c_ab3ec444c8457c9bc98aa07e846f5c1b7}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt@{B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt}}
\index{B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt@{B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Rsvd\-Sec\-Cnt~14	/$\ast$ Size of reserved area \mbox{[}sector\mbox{]} (2) $\ast$/}}\label{ff_8c_ab3ec444c8457c9bc98aa07e846f5c1b7}


Definition at line 396 of file ff.\-c.

\hypertarget{ff_8c_aab78e41c617a14b9540c0563d6b957fa}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Sec\-Per\-Clus@{B\-P\-B\-\_\-\-Sec\-Per\-Clus}}
\index{B\-P\-B\-\_\-\-Sec\-Per\-Clus@{B\-P\-B\-\_\-\-Sec\-Per\-Clus}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Sec\-Per\-Clus}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Sec\-Per\-Clus~13	/$\ast$ Cluster size \mbox{[}sector\mbox{]} (1) $\ast$/}}\label{ff_8c_aab78e41c617a14b9540c0563d6b957fa}


Definition at line 395 of file ff.\-c.

\hypertarget{ff_8c_ac71bb771432ea532bc47713a028ebd76}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Sec\-Per\-Trk@{B\-P\-B\-\_\-\-Sec\-Per\-Trk}}
\index{B\-P\-B\-\_\-\-Sec\-Per\-Trk@{B\-P\-B\-\_\-\-Sec\-Per\-Trk}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Sec\-Per\-Trk}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Sec\-Per\-Trk~24	/$\ast$ Track size \mbox{[}sector\mbox{]} (2) $\ast$/}}\label{ff_8c_ac71bb771432ea532bc47713a028ebd76}


Definition at line 402 of file ff.\-c.

\hypertarget{ff_8c_a4eb540eecde0f2df26fa8c7969341d68}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Tot\-Sec16@{B\-P\-B\-\_\-\-Tot\-Sec16}}
\index{B\-P\-B\-\_\-\-Tot\-Sec16@{B\-P\-B\-\_\-\-Tot\-Sec16}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Tot\-Sec16}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Tot\-Sec16~19	/$\ast$ Volume size \mbox{[}sector\mbox{]} (2) $\ast$/}}\label{ff_8c_a4eb540eecde0f2df26fa8c7969341d68}


Definition at line 399 of file ff.\-c.

\hypertarget{ff_8c_a7723a9f0da553e8879d60909d85ccb7b}{\index{ff.\-c@{ff.\-c}!B\-P\-B\-\_\-\-Tot\-Sec32@{B\-P\-B\-\_\-\-Tot\-Sec32}}
\index{B\-P\-B\-\_\-\-Tot\-Sec32@{B\-P\-B\-\_\-\-Tot\-Sec32}!ff.c@{ff.\-c}}
\subsubsection[{B\-P\-B\-\_\-\-Tot\-Sec32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-P\-B\-\_\-\-Tot\-Sec32~32	/$\ast$ Volume size \mbox{[}sector\mbox{]} (4) $\ast$/}}\label{ff_8c_a7723a9f0da553e8879d60909d85ccb7b}


Definition at line 405 of file ff.\-c.

\hypertarget{ff_8c_a74b810b3f3583c1eb54bd4305c0f261a}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-55\-A\-A@{B\-S\-\_\-55\-A\-A}}
\index{B\-S\-\_\-55\-A\-A@{B\-S\-\_\-55\-A\-A}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-55\-A\-A}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-55\-A\-A~510	/$\ast$ Boot sector signature (2) $\ast$/}}\label{ff_8c_a74b810b3f3583c1eb54bd4305c0f261a}


Definition at line 428 of file ff.\-c.

\hypertarget{ff_8c_a85a92e790602efef4da3a2f141611ce8}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Boot\-Sig@{B\-S\-\_\-\-Boot\-Sig}}
\index{B\-S\-\_\-\-Boot\-Sig@{B\-S\-\_\-\-Boot\-Sig}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Boot\-Sig}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Boot\-Sig~38	/$\ast$ Extended boot signature (1) $\ast$/}}\label{ff_8c_a85a92e790602efef4da3a2f141611ce8}


Definition at line 407 of file ff.\-c.

\hypertarget{ff_8c_a59c4b2f802ab4bc9319e5bd840e615b8}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Boot\-Sig32@{B\-S\-\_\-\-Boot\-Sig32}}
\index{B\-S\-\_\-\-Boot\-Sig32@{B\-S\-\_\-\-Boot\-Sig32}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Boot\-Sig32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Boot\-Sig32~66	/$\ast$ Extended boot signature (1) $\ast$/}}\label{ff_8c_a59c4b2f802ab4bc9319e5bd840e615b8}


Definition at line 418 of file ff.\-c.

\hypertarget{ff_8c_a0c51f7393341b839dfb241c2951f3ef4}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Drv\-Num@{B\-S\-\_\-\-Drv\-Num}}
\index{B\-S\-\_\-\-Drv\-Num@{B\-S\-\_\-\-Drv\-Num}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Drv\-Num}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Drv\-Num~36	/$\ast$ Physical drive number (2) $\ast$/}}\label{ff_8c_a0c51f7393341b839dfb241c2951f3ef4}


Definition at line 406 of file ff.\-c.

\hypertarget{ff_8c_aa670c7b495f5b347c442df67b188c58f}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Drv\-Num32@{B\-S\-\_\-\-Drv\-Num32}}
\index{B\-S\-\_\-\-Drv\-Num32@{B\-S\-\_\-\-Drv\-Num32}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Drv\-Num32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Drv\-Num32~64	/$\ast$ Physical drive number (2) $\ast$/}}\label{ff_8c_aa670c7b495f5b347c442df67b188c58f}


Definition at line 417 of file ff.\-c.

\hypertarget{ff_8c_a2264848692d36c1b2499c9b6a10acf75}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Fil\-Sys\-Type@{B\-S\-\_\-\-Fil\-Sys\-Type}}
\index{B\-S\-\_\-\-Fil\-Sys\-Type@{B\-S\-\_\-\-Fil\-Sys\-Type}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Fil\-Sys\-Type}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Fil\-Sys\-Type~54	/$\ast$ File system type (1) $\ast$/}}\label{ff_8c_a2264848692d36c1b2499c9b6a10acf75}


Definition at line 410 of file ff.\-c.

\hypertarget{ff_8c_a8d8786452966cd0ce579f2575a54a348}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Fil\-Sys\-Type32@{B\-S\-\_\-\-Fil\-Sys\-Type32}}
\index{B\-S\-\_\-\-Fil\-Sys\-Type32@{B\-S\-\_\-\-Fil\-Sys\-Type32}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Fil\-Sys\-Type32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Fil\-Sys\-Type32~82	/$\ast$ File system type (1) $\ast$/}}\label{ff_8c_a8d8786452966cd0ce579f2575a54a348}


Definition at line 421 of file ff.\-c.

\hypertarget{ff_8c_a8f81669ee736efb2b2b49c7b0985472d}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-jmp\-Boot@{B\-S\-\_\-jmp\-Boot}}
\index{B\-S\-\_\-jmp\-Boot@{B\-S\-\_\-jmp\-Boot}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-jmp\-Boot}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-jmp\-Boot~0	/$\ast$ Jump instruction (3) $\ast$/}}\label{ff_8c_a8f81669ee736efb2b2b49c7b0985472d}


Definition at line 392 of file ff.\-c.

\hypertarget{ff_8c_a02a76ada191ec2dc5f8af60ff3576da7}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-O\-E\-M\-Name@{B\-S\-\_\-\-O\-E\-M\-Name}}
\index{B\-S\-\_\-\-O\-E\-M\-Name@{B\-S\-\_\-\-O\-E\-M\-Name}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-O\-E\-M\-Name}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-O\-E\-M\-Name~3	/$\ast$ O\-E\-M name (8) $\ast$/}}\label{ff_8c_a02a76ada191ec2dc5f8af60ff3576da7}


Definition at line 393 of file ff.\-c.

\hypertarget{ff_8c_a383a71bda500a0fb5a37f4edd785acbf}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Vol\-I\-D@{B\-S\-\_\-\-Vol\-I\-D}}
\index{B\-S\-\_\-\-Vol\-I\-D@{B\-S\-\_\-\-Vol\-I\-D}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Vol\-I\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Vol\-I\-D~39	/$\ast$ Volume serial number (4) $\ast$/}}\label{ff_8c_a383a71bda500a0fb5a37f4edd785acbf}


Definition at line 408 of file ff.\-c.

\hypertarget{ff_8c_abaa3aafdcf5e83f8cb7e2bb373b13525}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Vol\-I\-D32@{B\-S\-\_\-\-Vol\-I\-D32}}
\index{B\-S\-\_\-\-Vol\-I\-D32@{B\-S\-\_\-\-Vol\-I\-D32}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Vol\-I\-D32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Vol\-I\-D32~67	/$\ast$ Volume serial number (4) $\ast$/}}\label{ff_8c_abaa3aafdcf5e83f8cb7e2bb373b13525}


Definition at line 419 of file ff.\-c.

\hypertarget{ff_8c_a28498ba4b07ff90aaa9628e81fb89d32}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Vol\-Lab@{B\-S\-\_\-\-Vol\-Lab}}
\index{B\-S\-\_\-\-Vol\-Lab@{B\-S\-\_\-\-Vol\-Lab}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Vol\-Lab}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Vol\-Lab~43	/$\ast$ Volume label (8) $\ast$/}}\label{ff_8c_a28498ba4b07ff90aaa9628e81fb89d32}


Definition at line 409 of file ff.\-c.

\hypertarget{ff_8c_a8241a49bce313184a58617ba1ad9e84c}{\index{ff.\-c@{ff.\-c}!B\-S\-\_\-\-Vol\-Lab32@{B\-S\-\_\-\-Vol\-Lab32}}
\index{B\-S\-\_\-\-Vol\-Lab32@{B\-S\-\_\-\-Vol\-Lab32}!ff.c@{ff.\-c}}
\subsubsection[{B\-S\-\_\-\-Vol\-Lab32}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-S\-\_\-\-Vol\-Lab32~71	/$\ast$ Volume label (8) $\ast$/}}\label{ff_8c_a8241a49bce313184a58617ba1ad9e84c}


Definition at line 420 of file ff.\-c.

\hypertarget{ff_8c_af39f317ac33b961daaff4b8d8a7ec792}{\index{ff.\-c@{ff.\-c}!D\-D\-E@{D\-D\-E}}
\index{D\-D\-E@{D\-D\-E}!ff.c@{ff.\-c}}
\subsubsection[{D\-D\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-D\-E~0x\-E5	/$\ast$ Deleted directory enrty mark in D\-I\-R\-\_\-\-Name\mbox{[}0\mbox{]} $\ast$/}}\label{ff_8c_af39f317ac33b961daaff4b8d8a7ec792}


Definition at line 447 of file ff.\-c.

\hypertarget{ff_8c_a40aba328871d2be78bfdd74b390275db}{\index{ff.\-c@{ff.\-c}!D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F@{D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F}}
\index{D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F@{D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F}!ff.c@{ff.\-c}}
\subsubsection[{D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F~{\bf P\-F\-\_\-\-B\-Y\-T\-E} sfn\mbox{[}12\mbox{]}}}\label{ff_8c_a40aba328871d2be78bfdd74b390275db}


Definition at line 477 of file ff.\-c.



Referenced by f\-\_\-chmod(), f\-\_\-mkdir(), f\-\_\-open(), f\-\_\-opendir(), f\-\_\-readdir(), f\-\_\-rename(), f\-\_\-stat(), f\-\_\-unlink(), and f\-\_\-utime().

\hypertarget{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Attr@{D\-I\-R\-\_\-\-Attr}}
\index{D\-I\-R\-\_\-\-Attr@{D\-I\-R\-\_\-\-Attr}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Attr}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Attr~11	/$\ast$ Attribute (1) $\ast$/}}\label{ff_8c_ad3233e40118ed66095f3c9545b788f8a}


Definition at line 431 of file ff.\-c.



Referenced by f\-\_\-chmod(), f\-\_\-mkdir(), f\-\_\-open(), f\-\_\-opendir(), f\-\_\-rename(), f\-\_\-sync(), and f\-\_\-unlink().

\hypertarget{ff_8c_acf498617bb4c7750fd738864c3c0ab5a}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Crt\-Date@{D\-I\-R\-\_\-\-Crt\-Date}}
\index{D\-I\-R\-\_\-\-Crt\-Date@{D\-I\-R\-\_\-\-Crt\-Date}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Crt\-Date}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Crt\-Date~16	/$\ast$ Created date (2) $\ast$/}}\label{ff_8c_acf498617bb4c7750fd738864c3c0ab5a}


Definition at line 434 of file ff.\-c.

\hypertarget{ff_8c_a47fb1881ea71d860db9b8280564cb4d5}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Crt\-Time@{D\-I\-R\-\_\-\-Crt\-Time}}
\index{D\-I\-R\-\_\-\-Crt\-Time@{D\-I\-R\-\_\-\-Crt\-Time}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Crt\-Time}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Crt\-Time~14	/$\ast$ Created time (2) $\ast$/}}\label{ff_8c_a47fb1881ea71d860db9b8280564cb4d5}


Definition at line 433 of file ff.\-c.



Referenced by f\-\_\-open().

\hypertarget{ff_8c_abfbfa613864a02a65f0bf70ead6672c7}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-File\-Size@{D\-I\-R\-\_\-\-File\-Size}}
\index{D\-I\-R\-\_\-\-File\-Size@{D\-I\-R\-\_\-\-File\-Size}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-File\-Size}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-File\-Size~28	/$\ast$ File size (4) $\ast$/}}\label{ff_8c_abfbfa613864a02a65f0bf70ead6672c7}


Definition at line 439 of file ff.\-c.



Referenced by f\-\_\-open(), and f\-\_\-sync().

\hypertarget{ff_8c_a0bc29c3f09e1e9c40c414f7d50d7905c}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Fst\-Clus\-H\-I@{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I}}
\index{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I@{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Fst\-Clus\-H\-I}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Fst\-Clus\-H\-I~20	/$\ast$ Higher 16-\/bit of first cluster (2) $\ast$/}}\label{ff_8c_a0bc29c3f09e1e9c40c414f7d50d7905c}


Definition at line 435 of file ff.\-c.

\hypertarget{ff_8c_aebe0e913bff75a89d38dbcb04baf5dff}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Fst\-Clus\-L\-O@{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}}
\index{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O@{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Fst\-Clus\-L\-O~26	/$\ast$ Lower 16-\/bit of first cluster (2) $\ast$/}}\label{ff_8c_aebe0e913bff75a89d38dbcb04baf5dff}


Definition at line 438 of file ff.\-c.

\hypertarget{ff_8c_afa89348e9fc2de82ae9e12c661366b0e}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Name@{D\-I\-R\-\_\-\-Name}}
\index{D\-I\-R\-\_\-\-Name@{D\-I\-R\-\_\-\-Name}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Name}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Name~0	/$\ast$ Short file name (11) $\ast$/}}\label{ff_8c_afa89348e9fc2de82ae9e12c661366b0e}


Definition at line 430 of file ff.\-c.



Referenced by f\-\_\-mkdir().

\hypertarget{ff_8c_a87ee1f701c2ab941862e3ce00c1c1e9d}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-N\-Tres@{D\-I\-R\-\_\-\-N\-Tres}}
\index{D\-I\-R\-\_\-\-N\-Tres@{D\-I\-R\-\_\-\-N\-Tres}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-N\-Tres}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-N\-Tres~12	/$\ast$ N\-T flag (1) $\ast$/}}\label{ff_8c_a87ee1f701c2ab941862e3ce00c1c1e9d}


Definition at line 432 of file ff.\-c.

\hypertarget{ff_8c_abed17fa699511b09cbf64961373d63a4}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Wrt\-Date@{D\-I\-R\-\_\-\-Wrt\-Date}}
\index{D\-I\-R\-\_\-\-Wrt\-Date@{D\-I\-R\-\_\-\-Wrt\-Date}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Wrt\-Date}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Wrt\-Date~24	/$\ast$ Modified date (2) $\ast$/}}\label{ff_8c_abed17fa699511b09cbf64961373d63a4}


Definition at line 437 of file ff.\-c.



Referenced by f\-\_\-utime().

\hypertarget{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}{\index{ff.\-c@{ff.\-c}!D\-I\-R\-\_\-\-Wrt\-Time@{D\-I\-R\-\_\-\-Wrt\-Time}}
\index{D\-I\-R\-\_\-\-Wrt\-Time@{D\-I\-R\-\_\-\-Wrt\-Time}!ff.c@{ff.\-c}}
\subsubsection[{D\-I\-R\-\_\-\-Wrt\-Time}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-I\-R\-\_\-\-Wrt\-Time~22	/$\ast$ Modified time (2) $\ast$/}}\label{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}


Definition at line 436 of file ff.\-c.



Referenced by f\-\_\-mkdir(), f\-\_\-sync(), and f\-\_\-utime().

\hypertarget{ff_8c_a458e336ac53f8249ed02d844469b7076}{\index{ff.\-c@{ff.\-c}!E\-N\-T\-E\-R\-\_\-\-F\-F@{E\-N\-T\-E\-R\-\_\-\-F\-F}}
\index{E\-N\-T\-E\-R\-\_\-\-F\-F@{E\-N\-T\-E\-R\-\_\-\-F\-F}!ff.c@{ff.\-c}}
\subsubsection[{E\-N\-T\-E\-R\-\_\-\-F\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\-N\-T\-E\-R\-\_\-\-F\-F(
\begin{DoxyParamCaption}
\item[{}]{fs}
\end{DoxyParamCaption}
)}}\label{ff_8c_a458e336ac53f8249ed02d844469b7076}


Definition at line 129 of file ff.\-c.

\hypertarget{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{\index{ff.\-c@{ff.\-c}!F\-R\-E\-E\-\_\-\-B\-U\-F@{F\-R\-E\-E\-\_\-\-B\-U\-F}}
\index{F\-R\-E\-E\-\_\-\-B\-U\-F@{F\-R\-E\-E\-\_\-\-B\-U\-F}!ff.c@{ff.\-c}}
\subsubsection[{F\-R\-E\-E\-\_\-\-B\-U\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-R\-E\-E\-\_\-\-B\-U\-F(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}


Definition at line 479 of file ff.\-c.



Referenced by f\-\_\-chmod(), f\-\_\-mkdir(), f\-\_\-open(), f\-\_\-opendir(), f\-\_\-readdir(), f\-\_\-rename(), f\-\_\-stat(), f\-\_\-unlink(), and f\-\_\-utime().

\hypertarget{ff_8c_ab711e50459aba01b11c6b46a7cc1410b}{\index{ff.\-c@{ff.\-c}!F\-S\-I\-\_\-\-Free\-\_\-\-Count@{F\-S\-I\-\_\-\-Free\-\_\-\-Count}}
\index{F\-S\-I\-\_\-\-Free\-\_\-\-Count@{F\-S\-I\-\_\-\-Free\-\_\-\-Count}!ff.c@{ff.\-c}}
\subsubsection[{F\-S\-I\-\_\-\-Free\-\_\-\-Count}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-S\-I\-\_\-\-Free\-\_\-\-Count~488	/$\ast$ F\-S\-I\-: Number of free clusters (4) $\ast$/}}\label{ff_8c_ab711e50459aba01b11c6b46a7cc1410b}


Definition at line 424 of file ff.\-c.

\hypertarget{ff_8c_a318e58c1966aba52b90ab98dcb649883}{\index{ff.\-c@{ff.\-c}!F\-S\-I\-\_\-\-Lead\-Sig@{F\-S\-I\-\_\-\-Lead\-Sig}}
\index{F\-S\-I\-\_\-\-Lead\-Sig@{F\-S\-I\-\_\-\-Lead\-Sig}!ff.c@{ff.\-c}}
\subsubsection[{F\-S\-I\-\_\-\-Lead\-Sig}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-S\-I\-\_\-\-Lead\-Sig~0	/$\ast$ F\-S\-I\-: Leading signature (4) $\ast$/}}\label{ff_8c_a318e58c1966aba52b90ab98dcb649883}


Definition at line 422 of file ff.\-c.

\hypertarget{ff_8c_a320700cedf300c9b418edf56e5e6b086}{\index{ff.\-c@{ff.\-c}!F\-S\-I\-\_\-\-Nxt\-\_\-\-Free@{F\-S\-I\-\_\-\-Nxt\-\_\-\-Free}}
\index{F\-S\-I\-\_\-\-Nxt\-\_\-\-Free@{F\-S\-I\-\_\-\-Nxt\-\_\-\-Free}!ff.c@{ff.\-c}}
\subsubsection[{F\-S\-I\-\_\-\-Nxt\-\_\-\-Free}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-S\-I\-\_\-\-Nxt\-\_\-\-Free~492	/$\ast$ F\-S\-I\-: Last allocated cluster (4) $\ast$/}}\label{ff_8c_a320700cedf300c9b418edf56e5e6b086}


Definition at line 425 of file ff.\-c.

\hypertarget{ff_8c_a3bac0e6ff5907873030db1d0a7c4ebef}{\index{ff.\-c@{ff.\-c}!F\-S\-I\-\_\-\-Struc\-Sig@{F\-S\-I\-\_\-\-Struc\-Sig}}
\index{F\-S\-I\-\_\-\-Struc\-Sig@{F\-S\-I\-\_\-\-Struc\-Sig}!ff.c@{ff.\-c}}
\subsubsection[{F\-S\-I\-\_\-\-Struc\-Sig}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\-S\-I\-\_\-\-Struc\-Sig~484	/$\ast$ F\-S\-I\-: Structure signature (4) $\ast$/}}\label{ff_8c_a3bac0e6ff5907873030db1d0a7c4ebef}


Definition at line 423 of file ff.\-c.

\hypertarget{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{\index{ff.\-c@{ff.\-c}!I\-N\-I\-T\-\_\-\-B\-U\-F@{I\-N\-I\-T\-\_\-\-B\-U\-F}}
\index{I\-N\-I\-T\-\_\-\-B\-U\-F@{I\-N\-I\-T\-\_\-\-B\-U\-F}!ff.c@{ff.\-c}}
\subsubsection[{I\-N\-I\-T\-\_\-\-B\-U\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-N\-I\-T\-\_\-\-B\-U\-F(
\begin{DoxyParamCaption}
\item[{}]{dobj}
\end{DoxyParamCaption}
)~(dobj).{\bf fn} = sfn}}\label{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}


Definition at line 478 of file ff.\-c.



Referenced by f\-\_\-chmod(), f\-\_\-mkdir(), f\-\_\-open(), f\-\_\-opendir(), f\-\_\-readdir(), f\-\_\-rename(), f\-\_\-stat(), f\-\_\-unlink(), and f\-\_\-utime().

\hypertarget{ff_8c_a58d63a832a117f179e41c7373d013dd6}{\index{ff.\-c@{ff.\-c}!Is\-D\-B\-C\-S1@{Is\-D\-B\-C\-S1}}
\index{Is\-D\-B\-C\-S1@{Is\-D\-B\-C\-S1}!ff.c@{ff.\-c}}
\subsubsection[{Is\-D\-B\-C\-S1}]{\setlength{\rightskip}{0pt plus 5cm}\#define Is\-D\-B\-C\-S1(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~((({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $>$= {\bf \-\_\-\-D\-F1\-S} \&\& ({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $<$= {\bf \-\_\-\-D\-F1\-E}) $\vert$$\vert$ (({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $>$= {\bf \-\_\-\-D\-F2\-S} \&\& ({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $<$= {\bf \-\_\-\-D\-F2\-E}))}}\label{ff_8c_a58d63a832a117f179e41c7373d013dd6}


Definition at line 356 of file ff.\-c.

\hypertarget{ff_8c_a66a3fa880af6078ef181656c1d7d8ef1}{\index{ff.\-c@{ff.\-c}!Is\-D\-B\-C\-S2@{Is\-D\-B\-C\-S2}}
\index{Is\-D\-B\-C\-S2@{Is\-D\-B\-C\-S2}!ff.c@{ff.\-c}}
\subsubsection[{Is\-D\-B\-C\-S2}]{\setlength{\rightskip}{0pt plus 5cm}\#define Is\-D\-B\-C\-S2(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~((({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $>$= {\bf \-\_\-\-D\-S1\-S} \&\& ({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $<$= {\bf \-\_\-\-D\-S1\-E}) $\vert$$\vert$ (({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $>$= {\bf \-\_\-\-D\-S2\-S} \&\& ({\bf P\-F\-\_\-\-B\-Y\-T\-E})({\bf c}) $<$= {\bf \-\_\-\-D\-S2\-E}))}}\label{ff_8c_a66a3fa880af6078ef181656c1d7d8ef1}


Definition at line 364 of file ff.\-c.

\hypertarget{ff_8c_a65dee564f69f2ec27f25b67a348018b9}{\index{ff.\-c@{ff.\-c}!Is\-Digit@{Is\-Digit}}
\index{Is\-Digit@{Is\-Digit}!ff.c@{ff.\-c}}
\subsubsection[{Is\-Digit}]{\setlength{\rightskip}{0pt plus 5cm}\#define Is\-Digit(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~((({\bf c})$>$='0')\&\&(({\bf c})$<$='9'))}}\label{ff_8c_a65dee564f69f2ec27f25b67a348018b9}


Definition at line 351 of file ff.\-c.

\hypertarget{ff_8c_a4a9d454724926bd51a3aed589a97f08b}{\index{ff.\-c@{ff.\-c}!Is\-Lower@{Is\-Lower}}
\index{Is\-Lower@{Is\-Lower}!ff.c@{ff.\-c}}
\subsubsection[{Is\-Lower}]{\setlength{\rightskip}{0pt plus 5cm}\#define Is\-Lower(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~((({\bf c})$>$='a')\&\&(({\bf c})$<$='z'))}}\label{ff_8c_a4a9d454724926bd51a3aed589a97f08b}


Definition at line 350 of file ff.\-c.

\hypertarget{ff_8c_a89b2514198590e139dd064c5d534f302}{\index{ff.\-c@{ff.\-c}!Is\-Upper@{Is\-Upper}}
\index{Is\-Upper@{Is\-Upper}!ff.c@{ff.\-c}}
\subsubsection[{Is\-Upper}]{\setlength{\rightskip}{0pt plus 5cm}\#define Is\-Upper(
\begin{DoxyParamCaption}
\item[{}]{{\bf c}}
\end{DoxyParamCaption}
)~((({\bf c})$>$='{\bf A}')\&\&(({\bf c})$<$='Z'))}}\label{ff_8c_a89b2514198590e139dd064c5d534f302}


Definition at line 349 of file ff.\-c.

\hypertarget{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{\index{ff.\-c@{ff.\-c}!L\-D\-\_\-\-C\-L\-U\-S\-T@{L\-D\-\_\-\-C\-L\-U\-S\-T}}
\index{L\-D\-\_\-\-C\-L\-U\-S\-T@{L\-D\-\_\-\-C\-L\-U\-S\-T}!ff.c@{ff.\-c}}
\subsubsection[{L\-D\-\_\-\-C\-L\-U\-S\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-D\-\_\-\-C\-L\-U\-S\-T(
\begin{DoxyParamCaption}
\item[{}]{{\bf dir}}
\end{DoxyParamCaption}
)~((({\bf D\-W\-O\-R\-D}){\bf L\-D\-\_\-\-W\-O\-R\-D}({\bf dir}+{\bf D\-I\-R\-\_\-\-Fst\-Clus\-H\-I})$<$$<$16) $\vert$ {\bf L\-D\-\_\-\-W\-O\-R\-D}({\bf dir}+{\bf D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}))}}\label{ff_8c_a19cd426084600d6007eb6f976c81fbdf}


Definition at line 149 of file ff.\-c.



Referenced by f\-\_\-open(), f\-\_\-opendir(), f\-\_\-rename(), and f\-\_\-unlink().

\hypertarget{ff_8c_a28dcd75633b49e40b42a31f0cf5f5929}{\index{ff.\-c@{ff.\-c}!L\-D\-I\-R\-\_\-\-Attr@{L\-D\-I\-R\-\_\-\-Attr}}
\index{L\-D\-I\-R\-\_\-\-Attr@{L\-D\-I\-R\-\_\-\-Attr}!ff.c@{ff.\-c}}
\subsubsection[{L\-D\-I\-R\-\_\-\-Attr}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-D\-I\-R\-\_\-\-Attr~11	/$\ast$ L\-F\-N attribute (1) $\ast$/}}\label{ff_8c_a28dcd75633b49e40b42a31f0cf5f5929}


Definition at line 441 of file ff.\-c.

\hypertarget{ff_8c_ade1d529763d2d097a6d1410956c8a84f}{\index{ff.\-c@{ff.\-c}!L\-D\-I\-R\-\_\-\-Chksum@{L\-D\-I\-R\-\_\-\-Chksum}}
\index{L\-D\-I\-R\-\_\-\-Chksum@{L\-D\-I\-R\-\_\-\-Chksum}!ff.c@{ff.\-c}}
\subsubsection[{L\-D\-I\-R\-\_\-\-Chksum}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-D\-I\-R\-\_\-\-Chksum~13	/$\ast$ Sum of corresponding S\-F\-N entry $\ast$/}}\label{ff_8c_ade1d529763d2d097a6d1410956c8a84f}


Definition at line 443 of file ff.\-c.

\hypertarget{ff_8c_ad73024151eff6baea94e680f7928969d}{\index{ff.\-c@{ff.\-c}!L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O@{L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}}
\index{L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O@{L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}!ff.c@{ff.\-c}}
\subsubsection[{L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-D\-I\-R\-\_\-\-Fst\-Clus\-L\-O~26	/$\ast$ Filled by zero (0) $\ast$/}}\label{ff_8c_ad73024151eff6baea94e680f7928969d}


Definition at line 444 of file ff.\-c.

\hypertarget{ff_8c_a6c97d545619e6586b02b5d4f39f7be25}{\index{ff.\-c@{ff.\-c}!L\-D\-I\-R\-\_\-\-Ord@{L\-D\-I\-R\-\_\-\-Ord}}
\index{L\-D\-I\-R\-\_\-\-Ord@{L\-D\-I\-R\-\_\-\-Ord}!ff.c@{ff.\-c}}
\subsubsection[{L\-D\-I\-R\-\_\-\-Ord}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-D\-I\-R\-\_\-\-Ord~0	/$\ast$ L\-F\-N entry order and {\bf L\-L\-E} flag (1) $\ast$/}}\label{ff_8c_a6c97d545619e6586b02b5d4f39f7be25}


Definition at line 440 of file ff.\-c.

\hypertarget{ff_8c_acb98a052a9be81564b56854df35480a0}{\index{ff.\-c@{ff.\-c}!L\-D\-I\-R\-\_\-\-Type@{L\-D\-I\-R\-\_\-\-Type}}
\index{L\-D\-I\-R\-\_\-\-Type@{L\-D\-I\-R\-\_\-\-Type}!ff.c@{ff.\-c}}
\subsubsection[{L\-D\-I\-R\-\_\-\-Type}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-D\-I\-R\-\_\-\-Type~12	/$\ast$ L\-F\-N type (1) $\ast$/}}\label{ff_8c_acb98a052a9be81564b56854df35480a0}


Definition at line 442 of file ff.\-c.

\hypertarget{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{\index{ff.\-c@{ff.\-c}!L\-E\-A\-V\-E\-\_\-\-F\-F@{L\-E\-A\-V\-E\-\_\-\-F\-F}}
\index{L\-E\-A\-V\-E\-\_\-\-F\-F@{L\-E\-A\-V\-E\-\_\-\-F\-F}!ff.c@{ff.\-c}}
\subsubsection[{L\-E\-A\-V\-E\-\_\-\-F\-F}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-E\-A\-V\-E\-\_\-\-F\-F(
\begin{DoxyParamCaption}
\item[{}]{fs, }
\item[{}]{{\bf res}}
\end{DoxyParamCaption}
)~return {\bf res}}}\label{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}


Definition at line 130 of file ff.\-c.



Referenced by f\-\_\-chmod(), f\-\_\-close(), f\-\_\-getfree(), f\-\_\-lseek(), f\-\_\-mkdir(), f\-\_\-open(), f\-\_\-opendir(), f\-\_\-read(), f\-\_\-readdir(), f\-\_\-rename(), f\-\_\-stat(), f\-\_\-sync(), f\-\_\-truncate(), f\-\_\-unlink(), f\-\_\-utime(), and f\-\_\-write().

\hypertarget{ff_8c_aff828b43518c49e1d637a822879b135d}{\index{ff.\-c@{ff.\-c}!L\-L\-E@{L\-L\-E}}
\index{L\-L\-E@{L\-L\-E}!ff.c@{ff.\-c}}
\subsubsection[{L\-L\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-L\-E~0x40	/$\ast$ Last long entry flag in L\-D\-I\-R\-\_\-\-Ord $\ast$/}}\label{ff_8c_aff828b43518c49e1d637a822879b135d}


Definition at line 446 of file ff.\-c.

\hypertarget{ff_8c_ac3f187bf0ba891551f594af6b61f3188}{\index{ff.\-c@{ff.\-c}!M\-B\-R\-\_\-\-Table@{M\-B\-R\-\_\-\-Table}}
\index{M\-B\-R\-\_\-\-Table@{M\-B\-R\-\_\-\-Table}!ff.c@{ff.\-c}}
\subsubsection[{M\-B\-R\-\_\-\-Table}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-B\-R\-\_\-\-Table~446	/$\ast$ M\-B\-R\-: Partition table offset (2) $\ast$/}}\label{ff_8c_ac3f187bf0ba891551f594af6b61f3188}


Definition at line 426 of file ff.\-c.

\hypertarget{ff_8c_aeec02d5ae07ede32b7d74155bf0fda15}{\index{ff.\-c@{ff.\-c}!M\-I\-N\-\_\-\-F\-A\-T16@{M\-I\-N\-\_\-\-F\-A\-T16}}
\index{M\-I\-N\-\_\-\-F\-A\-T16@{M\-I\-N\-\_\-\-F\-A\-T16}!ff.c@{ff.\-c}}
\subsubsection[{M\-I\-N\-\_\-\-F\-A\-T16}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-I\-N\-\_\-\-F\-A\-T16~4086	/$\ast$ Minimum number of clusters for F\-A\-T16 $\ast$/}}\label{ff_8c_aeec02d5ae07ede32b7d74155bf0fda15}


Definition at line 385 of file ff.\-c.

\hypertarget{ff_8c_a483625319f3e3bd5ac6502b46c375aed}{\index{ff.\-c@{ff.\-c}!M\-I\-N\-\_\-\-F\-A\-T32@{M\-I\-N\-\_\-\-F\-A\-T32}}
\index{M\-I\-N\-\_\-\-F\-A\-T32@{M\-I\-N\-\_\-\-F\-A\-T32}!ff.c@{ff.\-c}}
\subsubsection[{M\-I\-N\-\_\-\-F\-A\-T32}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-I\-N\-\_\-\-F\-A\-T32~65526	/$\ast$ Minimum number of clusters for F\-A\-T32 $\ast$/}}\label{ff_8c_a483625319f3e3bd5ac6502b46c375aed}


Definition at line 386 of file ff.\-c.

\hypertarget{ff_8c_a741d6fdda5989919e0bb9811da804e56}{\index{ff.\-c@{ff.\-c}!N\-D\-D\-E@{N\-D\-D\-E}}
\index{N\-D\-D\-E@{N\-D\-D\-E}!ff.c@{ff.\-c}}
\subsubsection[{N\-D\-D\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-D\-D\-E~0x05	/$\ast$ Replacement of a character collides with D\-D\-E $\ast$/}}\label{ff_8c_a741d6fdda5989919e0bb9811da804e56}


Definition at line 448 of file ff.\-c.

\hypertarget{ff_8c_a06c201f90533d5b49cd039c960327968}{\index{ff.\-c@{ff.\-c}!N\-S@{N\-S}}
\index{N\-S@{N\-S}!ff.c@{ff.\-c}}
\subsubsection[{N\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S~11		/$\ast$ Index of name {\bf status} {\bf byte} in {\bf fn}\mbox{[}$\,$\mbox{]} $\ast$/}}\label{ff_8c_a06c201f90533d5b49cd039c960327968}


Definition at line 375 of file ff.\-c.



Referenced by f\-\_\-chmod(), f\-\_\-mkdir(), f\-\_\-rename(), f\-\_\-unlink(), and f\-\_\-utime().

\hypertarget{ff_8c_a4a0e89b504dece19e2e4b02c83782ca2}{\index{ff.\-c@{ff.\-c}!N\-S\-\_\-\-B\-O\-D\-Y@{N\-S\-\_\-\-B\-O\-D\-Y}}
\index{N\-S\-\_\-\-B\-O\-D\-Y@{N\-S\-\_\-\-B\-O\-D\-Y}!ff.c@{ff.\-c}}
\subsubsection[{N\-S\-\_\-\-B\-O\-D\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S\-\_\-\-B\-O\-D\-Y~0x08	/$\ast$ Lower case flag (body) $\ast$/}}\label{ff_8c_a4a0e89b504dece19e2e4b02c83782ca2}


Definition at line 379 of file ff.\-c.

\hypertarget{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{\index{ff.\-c@{ff.\-c}!N\-S\-\_\-\-D\-O\-T@{N\-S\-\_\-\-D\-O\-T}}
\index{N\-S\-\_\-\-D\-O\-T@{N\-S\-\_\-\-D\-O\-T}!ff.c@{ff.\-c}}
\subsubsection[{N\-S\-\_\-\-D\-O\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S\-\_\-\-D\-O\-T~0x20	/$\ast$ Dot entry $\ast$/}}\label{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}


Definition at line 381 of file ff.\-c.

\hypertarget{ff_8c_a3b7fad0942e816fdb84d869c1f7a613e}{\index{ff.\-c@{ff.\-c}!N\-S\-\_\-\-E\-X\-T@{N\-S\-\_\-\-E\-X\-T}}
\index{N\-S\-\_\-\-E\-X\-T@{N\-S\-\_\-\-E\-X\-T}!ff.c@{ff.\-c}}
\subsubsection[{N\-S\-\_\-\-E\-X\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S\-\_\-\-E\-X\-T~0x10	/$\ast$ Lower case flag (ext) $\ast$/}}\label{ff_8c_a3b7fad0942e816fdb84d869c1f7a613e}


Definition at line 380 of file ff.\-c.

\hypertarget{ff_8c_a5a0742bfc1d94f0c3baa5ede485048c4}{\index{ff.\-c@{ff.\-c}!N\-S\-\_\-\-L\-A\-S\-T@{N\-S\-\_\-\-L\-A\-S\-T}}
\index{N\-S\-\_\-\-L\-A\-S\-T@{N\-S\-\_\-\-L\-A\-S\-T}!ff.c@{ff.\-c}}
\subsubsection[{N\-S\-\_\-\-L\-A\-S\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S\-\_\-\-L\-A\-S\-T~0x04	/$\ast$ Last segment $\ast$/}}\label{ff_8c_a5a0742bfc1d94f0c3baa5ede485048c4}


Definition at line 378 of file ff.\-c.

\hypertarget{ff_8c_ae957b8d4065ea0b3eed822aec5368d29}{\index{ff.\-c@{ff.\-c}!N\-S\-\_\-\-L\-F\-N@{N\-S\-\_\-\-L\-F\-N}}
\index{N\-S\-\_\-\-L\-F\-N@{N\-S\-\_\-\-L\-F\-N}!ff.c@{ff.\-c}}
\subsubsection[{N\-S\-\_\-\-L\-F\-N}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S\-\_\-\-L\-F\-N~0x02	/$\ast$ Force to create L\-F\-N entry $\ast$/}}\label{ff_8c_ae957b8d4065ea0b3eed822aec5368d29}


Definition at line 377 of file ff.\-c.

\hypertarget{ff_8c_ac92c92c3a3d6b9235ac98feeb00e565a}{\index{ff.\-c@{ff.\-c}!N\-S\-\_\-\-L\-O\-S\-S@{N\-S\-\_\-\-L\-O\-S\-S}}
\index{N\-S\-\_\-\-L\-O\-S\-S@{N\-S\-\_\-\-L\-O\-S\-S}!ff.c@{ff.\-c}}
\subsubsection[{N\-S\-\_\-\-L\-O\-S\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-S\-\_\-\-L\-O\-S\-S~0x01	/$\ast$ Out of 8.\-3 format $\ast$/}}\label{ff_8c_ac92c92c3a3d6b9235ac98feeb00e565a}


Definition at line 376 of file ff.\-c.

\hypertarget{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{\index{ff.\-c@{ff.\-c}!S\-S@{S\-S}}
\index{S\-S@{S\-S}!ff.c@{ff.\-c}}
\subsubsection[{S\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-S(
\begin{DoxyParamCaption}
\item[{}]{fs}
\end{DoxyParamCaption}
)~512\-U			/$\ast$ Fixed sector size $\ast$/}}\label{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}


Definition at line 118 of file ff.\-c.



Referenced by f\-\_\-getfree(), f\-\_\-lseek(), f\-\_\-mkdir(), f\-\_\-read(), f\-\_\-write(), get\-\_\-fat(), and put\-\_\-fat().

\hypertarget{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{\index{ff.\-c@{ff.\-c}!S\-T\-\_\-\-C\-L\-U\-S\-T@{S\-T\-\_\-\-C\-L\-U\-S\-T}}
\index{S\-T\-\_\-\-C\-L\-U\-S\-T@{S\-T\-\_\-\-C\-L\-U\-S\-T}!ff.c@{ff.\-c}}
\subsubsection[{S\-T\-\_\-\-C\-L\-U\-S\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-T\-\_\-\-C\-L\-U\-S\-T(
\begin{DoxyParamCaption}
\item[{}]{{\bf dir}, }
\item[{}]{cl}
\end{DoxyParamCaption}
)~\{{\bf S\-T\-\_\-\-W\-O\-R\-D}({\bf dir}+{\bf D\-I\-R\-\_\-\-Fst\-Clus\-L\-O}, cl); {\bf S\-T\-\_\-\-W\-O\-R\-D}({\bf dir}+{\bf D\-I\-R\-\_\-\-Fst\-Clus\-H\-I}, ({\bf D\-W\-O\-R\-D})cl$>$$>$16);\}}}\label{ff_8c_a08174fa72222a48a5c9e5de70c341af7}


Definition at line 150 of file ff.\-c.



Referenced by f\-\_\-mkdir(), f\-\_\-open(), f\-\_\-rename(), and f\-\_\-sync().

\hypertarget{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}{\index{ff.\-c@{ff.\-c}!S\-Z\-\_\-\-D\-I\-R@{S\-Z\-\_\-\-D\-I\-R}}
\index{S\-Z\-\_\-\-D\-I\-R@{S\-Z\-\_\-\-D\-I\-R}!ff.c@{ff.\-c}}
\subsubsection[{S\-Z\-\_\-\-D\-I\-R}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-Z\-\_\-\-D\-I\-R~32		/$\ast$ Size of a directory entry $\ast$/}}\label{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}


Definition at line 445 of file ff.\-c.



Referenced by f\-\_\-mkdir(), and f\-\_\-rename().

\hypertarget{ff_8c_af133060c47366e7e557d4085d931183f}{\index{ff.\-c@{ff.\-c}!S\-Z\-\_\-\-P\-T\-E@{S\-Z\-\_\-\-P\-T\-E}}
\index{S\-Z\-\_\-\-P\-T\-E@{S\-Z\-\_\-\-P\-T\-E}!ff.c@{ff.\-c}}
\subsubsection[{S\-Z\-\_\-\-P\-T\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-Z\-\_\-\-P\-T\-E~16	/$\ast$ M\-B\-R\-: Size of a partition table entry $\ast$/}}\label{ff_8c_af133060c47366e7e557d4085d931183f}


Definition at line 427 of file ff.\-c.



\subsection{Function Documentation}
\hypertarget{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{\index{ff.\-c@{ff.\-c}!clust2sect@{clust2sect}}
\index{clust2sect@{clust2sect}!ff.c@{ff.\-c}}
\subsubsection[{clust2sect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf D\-W\-O\-R\-D} clust2sect (
\begin{DoxyParamCaption}
\item[{{\bf F\-A\-T\-F\-S} $\ast$}]{fs, }
\item[{{\bf D\-W\-O\-R\-D}}]{clst}
\end{DoxyParamCaption}
)}}\label{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}


Definition at line 764 of file ff.\-c.



References F\-A\-T\-F\-S\-::csize, F\-A\-T\-F\-S\-::database, and F\-A\-T\-F\-S\-::n\-\_\-fatent.



Referenced by f\-\_\-lseek(), f\-\_\-mkdir(), f\-\_\-opendir(), f\-\_\-read(), f\-\_\-rename(), f\-\_\-unlink(), and f\-\_\-write().


\begin{DoxyCode}
767   \{
768     clst -= 2;
769     \textcolor{keywordflow}{if} (clst >= (fs->\hyperlink{struct_f_a_t_f_s_a388eb0fa0f3f1449a6ab88c6674e16fc}{n\_fatent} - 2))
770         \textcolor{keywordflow}{return} 0; \textcolor{comment}{/* Invalid cluster# */}
771     \textcolor{keywordflow}{return} clst * fs->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} + fs->\hyperlink{struct_f_a_t_f_s_ae3045fb3d76867c0cd17e6513000146b}{database};
772 \}
\end{DoxyCode}
\hypertarget{ff_8c_ad563f5cb82b21088065426a18fd0680a}{\index{ff.\-c@{ff.\-c}!f\-\_\-chmod@{f\-\_\-chmod}}
\index{f\-\_\-chmod@{f\-\_\-chmod}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-chmod}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-chmod (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path, }
\item[{{\bf P\-F\-\_\-\-B\-Y\-T\-E}}]{value, }
\item[{{\bf P\-F\-\_\-\-B\-Y\-T\-E}}]{mask}
\end{DoxyParamCaption}
)}}\label{ff_8c_ad563f5cb82b21088065426a18fd0680a}


Definition at line 3244 of file ff.\-c.



References \-\_\-\-F\-S\-\_\-\-R\-P\-A\-T\-H, A\-M\-\_\-\-A\-R\-C, A\-M\-\_\-\-H\-I\-D, A\-M\-\_\-\-R\-D\-O, A\-M\-\_\-\-S\-Y\-S, D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, dir, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Attr, dj, D\-I\-R\-::fn, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-O\-K, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-S, res, and F\-A\-T\-F\-S\-::wflag.


\begin{DoxyCode}
3247   \{
3248     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
3249     \hyperlink{struct_d_i_r}{DIR} \hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj};
3250     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
3251     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
3252 
3253     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 1);
3254     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3255         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(dj);
3256         res = follow\_path(&dj, path); \textcolor{comment}{/* Follow the file path */}
3257         \hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
3258         \textcolor{keywordflow}{if} (\hyperlink{ffconf_8h_a52faf11025401372f71e9d81905b7af4}{\_FS\_RPATH} && res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && (dj.\hyperlink{struct_d_i_r_af5245f40680a50c52ce1028bbe62d9f9}{fn}[\hyperlink{ff_8c_a06c201f90533d5b49cd039c960327968}{NS}] & \hyperlink{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{NS\_DOT}))
3259             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
3260         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3261             dir = dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir};
3262             \textcolor{keywordflow}{if} (!dir) \{ \textcolor{comment}{/* Is it a root directory? */}
3263                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
3264             \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* File or sub directory */}
3265                 mask &= \hyperlink{pff_8h_add6d85d1e7a02b4f6188783ef91a5f1e}{AM\_RDO} | \hyperlink{pff_8h_aa90c4c921c1955fd407d8bbf17f1674e}{AM\_HID} | \hyperlink{pff_8h_a1f25d5c17b5a3a6397b3398add8cdc15}{AM\_SYS} | \hyperlink{pff_8h_ae8174d00798e34e7c9e95898cb9e1a09}{AM\_ARC}; \textcolor{comment}{/* Valid attribute mask 
      */}
3266                 dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] = (value & mask) | (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}]
3267                         & (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) ~mask); \textcolor{comment}{/* Apply attribute change */}
3268                 dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
3269                 res = sync(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs});
3270             \}
3271         \}
3272     \}
3273 
3274     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
3275 \}
\end{DoxyCode}
\hypertarget{ff_8c_a53882db20ef4323dcfd1874d7733ffc3}{\index{ff.\-c@{ff.\-c}!f\-\_\-close@{f\-\_\-close}}
\index{f\-\_\-close@{f\-\_\-close}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-close}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-close (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp}
\end{DoxyParamCaption}
)}}\label{ff_8c_a53882db20ef4323dcfd1874d7733ffc3}


Definition at line 2568 of file ff.\-c.



References f\-\_\-sync(), F\-R\-\_\-\-O\-K, F\-I\-L\-::fs, F\-I\-L\-::id, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-U\-L\-L, and res.


\begin{DoxyCode}
2569   \{
2570     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2571 
2572 \textcolor{preprocessor}{#if \_FS\_READONLY}
2573 \textcolor{preprocessor}{}    \hyperlink{struct_f_a_t_f_s}{FATFS} *fs = fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs};
2574     res = validate(fs, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id});
2575     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs} = 0; \textcolor{comment}{/* Discard file object */}
2576     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fs, res);
2577 
2578 \textcolor{preprocessor}{#else}
2579 \textcolor{preprocessor}{}    res = \hyperlink{ff_8c_ad69c7246b122ba56a134939ee0eaf847}{f\_sync}(fp); \textcolor{comment}{/* Flush cached data */}
2580 \textcolor{preprocessor}{#if \_FS\_SHARE}
2581 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Decrement open counter */}
2582 \textcolor{preprocessor}{#if \_FS\_REENTRANT}
2583 \textcolor{preprocessor}{}        res = validate(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id});
2584         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2585             res = dec\_lock(fp->lockid);
2586             unlock\_fs(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK});
2587         \}
2588 \textcolor{preprocessor}{#else}
2589 \textcolor{preprocessor}{}        res = dec\_lock(fp->lockid);
2590 \textcolor{preprocessor}{#endif}
2591 \textcolor{preprocessor}{}    \}
2592 \textcolor{preprocessor}{#endif}
2593 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
2594         fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs} = 0; \textcolor{comment}{/* Discard file object */}
2595     \textcolor{keywordflow}{return} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2596 \textcolor{preprocessor}{#endif}
2597 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{ff_8c_a0ff39f75a87cbda9cd6ea65d83f16cec}{\index{ff.\-c@{ff.\-c}!f\-\_\-getfree@{f\-\_\-getfree}}
\index{f\-\_\-getfree@{f\-\_\-getfree}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-getfree}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-getfree (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path, }
\item[{{\bf D\-W\-O\-R\-D} $\ast$}]{nclst, }
\item[{{\bf F\-A\-T\-F\-S} $\ast$$\ast$}]{fatfs}
\end{DoxyParamCaption}
)}}\label{ff_8c_a0ff39f75a87cbda9cd6ea65d83f16cec}


Definition at line 2989 of file ff.\-c.



References \-\_\-\-F\-A\-T32, F\-A\-T\-F\-S\-::fatbase, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-A\-T\-F\-S\-::free\-\_\-clust, F\-S\-\_\-\-F\-A\-T12, F\-S\-\_\-\-F\-A\-T16, F\-S\-\_\-\-F\-A\-T32, F\-A\-T\-F\-S\-::fs\-\_\-type, F\-A\-T\-F\-S\-::fsi\-\_\-flag, get\-\_\-fat(), L\-D\-\_\-\-D\-W\-O\-R\-D, L\-D\-\_\-\-W\-O\-R\-D, L\-E\-A\-V\-E\-\_\-\-F\-F, F\-A\-T\-F\-S\-::max\-\_\-clust, res, S\-S, and F\-A\-T\-F\-S\-::win.


\begin{DoxyCode}
2992   \{
2993     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2994     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} n, clst, sect, stat;
2995     \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT} i;
2996     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} fat, *p;
2997 
2998     \textcolor{comment}{/* Get drive number */}
2999     res = chk\_mounted(&path, fatfs, 0);
3000     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3001         \textcolor{comment}{/* If free\_clust is valid, return it without full cluster scan */}
3002         \textcolor{keywordflow}{if} ((*fatfs)->free\_clust <= (*fatfs)->n\_fatent - 2) \{
3003             *nclst = (*fatfs)->free\_clust;
3004         \} \textcolor{keywordflow}{else} \{
3005             \textcolor{comment}{/* Get number of free clusters */}
3006             fat = (*fatfs)->fs\_type;
3007             n = 0;
3008             \textcolor{keywordflow}{if} (fat == \hyperlink{pff_8h_aab755aa1b4f81f4aabee4a5d4738cfb0}{FS\_FAT12}) \{
3009                 clst = 2;
3010                 \textcolor{keywordflow}{do} \{
3011                     stat = \hyperlink{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{get\_fat}(*fatfs, clst);
3012                     \textcolor{keywordflow}{if} (stat == 0xFFFFFFFF) \{
3013                         res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR};
3014                         \textcolor{keywordflow}{break};
3015                     \}
3016                     \textcolor{keywordflow}{if} (stat == 1) \{
3017                         res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
3018                         \textcolor{keywordflow}{break};
3019                     \}
3020                     \textcolor{keywordflow}{if} (stat == 0)
3021                         n++;
3022                 \} \textcolor{keywordflow}{while} (++clst < (*fatfs)->n\_fatent);
3023             \} \textcolor{keywordflow}{else} \{
3024                 clst = (*fatfs)->n\_fatent;
3025                 sect = (*fatfs)->fatbase;
3026                 i = 0;
3027                 p = 0;
3028                 \textcolor{keywordflow}{do} \{
3029                     \textcolor{keywordflow}{if} (!i) \{
3030                         res = move\_window(*fatfs, sect++);
3031                         \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3032                             \textcolor{keywordflow}{break};
3033                         p = (*fatfs)->win;
3034                         i = \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(*fatfs);
3035                     \}
3036                     \textcolor{keywordflow}{if} (fat == \hyperlink{pff_8h_a7ef90a36d99edfc0138a2155a17a79b9}{FS\_FAT16}) \{
3037                         \textcolor{keywordflow}{if} (\hyperlink{pff_8h_a398519bb08da6457e62567d1f0b567e3}{LD\_WORD}(p) == 0)
3038                             n++;
3039                         p += 2;
3040                         i -= 2;
3041                     \} \textcolor{keywordflow}{else} \{
3042                         \textcolor{keywordflow}{if} ((\hyperlink{pff_8h_a4690304ddc975516f7dc02575c96e34e}{LD\_DWORD}(p) & 0x0FFFFFFF) == 0)
3043                             n++;
3044                         p += 4;
3045                         i -= 4;
3046                     \}
3047                 \} \textcolor{keywordflow}{while} (--clst);
3048             \}
3049             (*fatfs)->free\_clust = n;
3050             \textcolor{keywordflow}{if} (fat == \hyperlink{pff_8h_ac63e0796095a789cefdbc3c3c676c9ce}{FS\_FAT32})
3051                 (*fatfs)->fsi\_flag = 1;
3052             *nclst = n;
3053         \}
3054     \}
3055     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(*fatfs, res);
3056 \}
\end{DoxyCode}
\hypertarget{ff_8c_a5df0ac672ada972e89ef4b003e57f964}{\index{ff.\-c@{ff.\-c}!f\-\_\-lseek@{f\-\_\-lseek}}
\index{f\-\_\-lseek@{f\-\_\-lseek}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-lseek}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-lseek (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{{\bf D\-W\-O\-R\-D}}]{ofs}
\end{DoxyParamCaption}
)}}\label{ff_8c_a5df0ac672ada972e89ef4b003e57f964}


Definition at line 2721 of file ff.\-c.



References \-\_\-\-F\-S\-\_\-\-R\-E\-A\-D\-O\-N\-L\-Y, A\-B\-O\-R\-T, F\-I\-L\-::buf, F\-I\-L\-::cltbl, F\-I\-L\-::clust, clust2sect(), C\-R\-E\-A\-T\-E\-\_\-\-L\-I\-N\-K\-M\-A\-P, F\-I\-L\-::csect, F\-A\-T\-F\-S\-::csize, F\-I\-L\-::curr\-\_\-clust, disk\-\_\-read(), disk\-\_\-write(), F\-A\-T\-F\-S\-::drv, F\-I\-L\-::dsect, F\-A\-\_\-\-\_\-\-D\-I\-R\-T\-Y, F\-A\-\_\-\-\_\-\-E\-R\-R\-O\-R, F\-A\-\_\-\-\_\-\-W\-R\-I\-T\-T\-E\-N, F\-A\-\_\-\-W\-R\-I\-T\-E, F\-I\-L\-::flag, F\-I\-L\-::fptr, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-N\-O\-T\-\_\-\-E\-N\-O\-U\-G\-H\-\_\-\-C\-O\-R\-E, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-I\-L\-::fs, F\-I\-L\-::fsize, get\-\_\-fat(), F\-I\-L\-::id, if(), L\-E\-A\-V\-E\-\_\-\-F\-F, F\-A\-T\-F\-S\-::max\-\_\-clust, F\-A\-T\-F\-S\-::n\-\_\-fatent, F\-I\-L\-::org\-\_\-clust, res, R\-E\-S\-\_\-\-O\-K, F\-I\-L\-::sclust, and S\-S.


\begin{DoxyCode}
2723   \{
2724     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2725 
2726     res = validate(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}); \textcolor{comment}{/* Check validity of the object */}
2727     \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
2728         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2729     \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_ad3b47fe8126573b17752a9a242b76b9a}{FA\_\_ERROR}) \textcolor{comment}{/* Check abort flag */}
2730         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2731 
2732 \textcolor{preprocessor}{#if \_USE\_FASTSEEK}
2733 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a807e335a4d92639456ac4273cb0de4cb}{cltbl}) \{ \textcolor{comment}{/* Fast seek */}
2734         \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} cl, pcl, ncl, tcl, dsc, tlen, ulen, *tbl;
2735 
2736         \textcolor{keywordflow}{if} (ofs == \hyperlink{ff_8h_aee297a9011164cf485a4df2a72758b08}{CREATE\_LINKMAP}) \{ \textcolor{comment}{/* Create CLMT */}
2737             tbl = fp->\hyperlink{struct_f_i_l_a807e335a4d92639456ac4273cb0de4cb}{cltbl};
2738             tlen = *tbl++;
2739             ulen = 2; \textcolor{comment}{/* Given table size and required table size */}
2740             cl = fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust}; \textcolor{comment}{/* Top of the chain */}
2741             \textcolor{keywordflow}{if} (cl) \{
2742                 \textcolor{keywordflow}{do} \{
2743                     \textcolor{comment}{/* Get a fragment */}
2744                     tcl = cl;
2745                     ncl = 0;
2746                     ulen += 2; \textcolor{comment}{/* Top, length and used items */}
2747                     \textcolor{keywordflow}{do} \{
2748                         pcl = cl;
2749                         ncl++;
2750                         cl = \hyperlink{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{get\_fat}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, cl);
2751                         \textcolor{keywordflow}{if} (cl <= 1)
2752                             \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2753                         \textcolor{keywordflow}{if} (cl == 0xFFFFFFFF)
2754                             \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2755                     \} \textcolor{keywordflow}{while} (cl == pcl + 1);
2756                     \textcolor{keywordflow}{if} (ulen <= tlen) \{ \textcolor{comment}{/* Store the length and top of the fragment */}
2757                         *tbl++ = ncl;
2758                         *tbl++ = tcl;
2759                     \}
2760                 \} \textcolor{keywordflow}{while} (cl < fp->fs->n\_fatent); \textcolor{comment}{/* Repeat until end of chain */}
2761             \}
2762             *fp->\hyperlink{struct_f_i_l_a807e335a4d92639456ac4273cb0de4cb}{cltbl} = ulen; \textcolor{comment}{/* Number of items used */}
2763             \textcolor{keywordflow}{if} (ulen <= tlen)
2764                 *tbl = 0; \textcolor{comment}{/* Terminate table */}
2765             \textcolor{keywordflow}{else}
2766                 res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44caf56a76a86602cbdeb2c4f3d00cfad21c}{FR\_NOT\_ENOUGH\_CORE}; \textcolor{comment}{/* Given table size is smaller than required */}
2767 
2768         \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* Fast seek */}
2769             \textcolor{keywordflow}{if} (ofs > fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize}) \textcolor{comment}{/* Clip offset at the file size */}
2770                 ofs = fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize};
2771             fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} = ofs; \textcolor{comment}{/* Set file pointer */}
2772             \textcolor{keywordflow}{if} (ofs) \{
2773                 fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust} = clmt\_clust(fp, ofs - 1);
2774                 dsc = \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust});
2775                 \textcolor{keywordflow}{if} (!dsc)
2776                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2777                 dsc += (ofs - 1) / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) & (fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} - 1);
2778                 \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) && dsc != fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}) \{ \textcolor{comment}{/* Refill sector cache if
       needed */}
2779 \textcolor{preprocessor}{#if !\_FS\_TINY}
2780 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if !\_FS\_READONLY}
2781 \textcolor{preprocessor}{}                    \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY}) \{ \textcolor{comment}{/* Write-back dirty sector cache */}
2782                         \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a7ffe0ccc946550a260d00871c6b636e7}{disk\_write}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, fp->
      \hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}, 1)
2783                                 != \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2784                             \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2785                         fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2786                     \}
2787 \textcolor{preprocessor}{#endif}
2788 \textcolor{preprocessor}{}                    \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a77ba19c0c97a900fac95999446e32308}{disk\_read}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, dsc, 1) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK}) \textcolor{comment}{/* Load current sector */}
2789                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2790 \textcolor{preprocessor}{#endif}
2791 \textcolor{preprocessor}{}                    fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} = dsc;
2792                 \}
2793             \}
2794         \}
2795     \} \textcolor{keywordflow}{else}
2796 \textcolor{preprocessor}{#endif}
2797 \textcolor{preprocessor}{}
2798     \textcolor{comment}{/* Normal Seek */}
2799     \{
2800         \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} clst, bcs, nsect, ifptr;
2801 
2802         \textcolor{keywordflow}{if} (ofs > fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} \textcolor{comment}{/* In read-only mode, clip offset with the file size */}
2803 #\textcolor{keywordflow}{if} !\hyperlink{tff_8h_afb8d35370cfe0c23832ac2d82e854ec6}{\_FS\_READONLY}
2804                 && !(fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_afa366963220c89b882c0361794020c14}{FA\_WRITE})
2805 \textcolor{preprocessor}{#endif}
2806 \textcolor{preprocessor}{}        )
2807             ofs = fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize};
2808 
2809         ifptr = fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr};
2810         fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} = nsect = 0;
2811         \hyperlink{p8_2pinguino_2libraries_2_p_c_d8544_8c_af84ca11bf86c56a1f74027a99d48218d}{if} (ofs) \{
2812             bcs = (\hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD}) fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} * \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}); \textcolor{comment}{/* Cluster size (byte) */}
2813             \textcolor{keywordflow}{if} (ifptr > 0 && (ofs - 1) / bcs >= (ifptr - 1) / bcs) \{ \textcolor{comment}{/* When seek to same or following
       cluster, */}
2814                 fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} = (ifptr - 1) & ~(bcs - 1); \textcolor{comment}{/* start from the current cluster */}
2815                 ofs -= fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr};
2816                 clst = fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust};
2817             \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* When seek to back cluster, */}
2818                 clst = fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust}; \textcolor{comment}{/* start from the first cluster */}
2819 \textcolor{preprocessor}{#if !\_FS\_READONLY}
2820 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} (clst == 0) \{ \textcolor{comment}{/* If no cluster chain, create a new chain */}
2821                     clst = create\_chain(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0);
2822                     \textcolor{keywordflow}{if} (clst == 1)
2823                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2824                     \textcolor{keywordflow}{if} (clst == 0xFFFFFFFF)
2825                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2826                     fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust} = clst;
2827                 \}
2828 \textcolor{preprocessor}{#endif}
2829 \textcolor{preprocessor}{}                fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust} = clst;
2830             \}
2831             \textcolor{keywordflow}{if} (clst != 0) \{
2832                 \textcolor{keywordflow}{while} (ofs > bcs) \{ \textcolor{comment}{/* Cluster following loop */}
2833 \textcolor{preprocessor}{#if !\_FS\_READONLY}
2834 \textcolor{preprocessor}{}                    \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_afa366963220c89b882c0361794020c14}{FA\_WRITE}) \{ \textcolor{comment}{/* Check if in write mode or not */}
2835                         clst = create\_chain(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, clst); \textcolor{comment}{/* Force stretch if in write mode */}
2836                         \textcolor{keywordflow}{if} (clst == 0) \{ \textcolor{comment}{/* When disk gets full, clip file size */}
2837                             ofs = bcs;
2838                             \textcolor{keywordflow}{break};
2839                         \}
2840                     \} \textcolor{keywordflow}{else}
2841 \textcolor{preprocessor}{#endif}
2842 \textcolor{preprocessor}{}                        clst = \hyperlink{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{get\_fat}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, clst); \textcolor{comment}{/* Follow cluster chain if not in write mode
       */}
2843                     \textcolor{keywordflow}{if} (clst == 0xFFFFFFFF)
2844                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2845                     \textcolor{keywordflow}{if} (clst <= 1 || clst >= fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a388eb0fa0f3f1449a6ab88c6674e16fc}{n\_fatent})
2846                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2847                     fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust} = clst;
2848                     fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} += bcs;
2849                     ofs -= bcs;
2850                 \}
2851                 fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} += ofs;
2852                 \textcolor{keywordflow}{if} (ofs % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})) \{
2853                     nsect = \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, clst); \textcolor{comment}{/* Current sector */}
2854                     \textcolor{keywordflow}{if} (!nsect)
2855                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2856                     nsect += ofs / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs});
2857                 \}
2858             \}
2859         \}
2860         \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) && nsect != fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}) \{ \textcolor{comment}{/* Fill sector cache if needed */}
2861 \textcolor{preprocessor}{#if !\_FS\_TINY}
2862 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if !\_FS\_READONLY}
2863 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY}) \{ \textcolor{comment}{/* Write-back dirty sector cache */}
2864                 \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a7ffe0ccc946550a260d00871c6b636e7}{disk\_write}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}, 1) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2865                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2866                 fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2867             \}
2868 \textcolor{preprocessor}{#endif}
2869 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a77ba19c0c97a900fac95999446e32308}{disk\_read}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, nsect, 1) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK}) \textcolor{comment}{/* Fill sector cache */}
2870                 \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2871 \textcolor{preprocessor}{#endif}
2872 \textcolor{preprocessor}{}            fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} = nsect;
2873         \}
2874 \textcolor{preprocessor}{#if !\_FS\_READONLY}
2875 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} > fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize}) \{ \textcolor{comment}{/* Set file change flag if the file size is extended */}
2876             fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} = fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr};
2877             fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} |= \hyperlink{tff_8h_ac4b7d5223f84df91c306ffbff536fae4}{FA\_\_WRITTEN};
2878         \}
2879 \textcolor{preprocessor}{#endif}
2880 \textcolor{preprocessor}{}    \}
2881 
2882     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2883 \}
\end{DoxyCode}
\hypertarget{ff_8c_a4b4d38db58e89c526cfcf53200d719d0}{\index{ff.\-c@{ff.\-c}!f\-\_\-mkdir@{f\-\_\-mkdir}}
\index{f\-\_\-mkdir@{f\-\_\-mkdir}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-mkdir}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-mkdir (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path}
\end{DoxyParamCaption}
)}}\label{ff_8c_a4b4d38db58e89c526cfcf53200d719d0}


Definition at line 3171 of file ff.\-c.



References \-\_\-\-F\-S\-\_\-\-R\-P\-A\-T\-H, A\-M\-\_\-\-D\-I\-R, clust2sect(), F\-A\-T\-F\-S\-::csize, D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, dir, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-Fst\-Clus\-H\-I, D\-I\-R\-\_\-\-Fst\-Clus\-L\-O, D\-I\-R\-\_\-\-Name, D\-I\-R\-\_\-\-N\-Tres, D\-I\-R\-\_\-\-Wrt\-Time, F\-A\-T\-F\-S\-::dirbase, disk\-\_\-write(), dj, D\-I\-R\-::fn, F\-R\-\_\-\-D\-E\-N\-I\-E\-D, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-E\-X\-I\-S\-T, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, F\-S\-\_\-\-F\-A\-T32, F\-A\-T\-F\-S\-::fs\-\_\-type, get\-\_\-fattime(), I\-N\-I\-T\-\_\-\-B\-U\-F, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-S, res, R\-E\-S\-\_\-\-O\-K, D\-I\-R\-::sclust, S\-S, S\-T\-\_\-\-C\-L\-U\-S\-T, S\-T\-\_\-\-D\-W\-O\-R\-D, S\-T\-\_\-\-W\-O\-R\-D, S\-Z\-\_\-\-D\-I\-R, F\-A\-T\-F\-S\-::wflag, F\-A\-T\-F\-S\-::win, F\-A\-T\-F\-S\-::winflag, and F\-A\-T\-F\-S\-::winsect.


\begin{DoxyCode}
3172   \{
3173     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
3174     \hyperlink{struct_d_i_r}{DIR} \hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj};
3175     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir}, n;
3176     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} dsc, dcl, pcl, tim = \hyperlink{tff_8h_a489f23a9be58cd896a5c45e45c6e6e6f}{get\_fattime}();
3177     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
3178 
3179     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 1);
3180     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3181         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(dj);
3182         res = follow\_path(&dj, path); \textcolor{comment}{/* Follow the file path */}
3183         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3184             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450}{FR\_EXIST}; \textcolor{comment}{/* Any object with same name is already existing */}
3185         \textcolor{keywordflow}{if} (\hyperlink{ffconf_8h_a52faf11025401372f71e9d81905b7af4}{\_FS\_RPATH} && res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE} && (dj.\hyperlink{struct_d_i_r_af5245f40680a50c52ce1028bbe62d9f9}{fn}[\hyperlink{ff_8c_a06c201f90533d5b49cd039c960327968}{NS}] & 
      \hyperlink{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{NS\_DOT}))
3186             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
3187         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE}) \{ \textcolor{comment}{/* Can create a new directory */}
3188             dcl = create\_chain(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0); \textcolor{comment}{/* Allocate a cluster for the new directory table */}
3189             res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK};
3190             \textcolor{keywordflow}{if} (dcl == 0)
3191                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED}; \textcolor{comment}{/* No space to allocate a new cluster */}
3192             \textcolor{keywordflow}{if} (dcl == 1)
3193                 res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
3194             \textcolor{keywordflow}{if} (dcl == 0xFFFFFFFF)
3195                 res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR};
3196             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \textcolor{comment}{/* Flush FAT */}
3197                 res = move\_window(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0);
3198             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Initialize the new directory table */}
3199                 dsc = \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, dcl);
3200                 dir = dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win};
3201                 mem\_set(dir, 0, \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}));
3202                 mem\_set(dir + \hyperlink{ff_8c_afa89348e9fc2de82ae9e12c661366b0e}{DIR\_Name}, \textcolor{charliteral}{' '}, 8 + 3); \textcolor{comment}{/* Create "." entry */}
3203                 dir[\hyperlink{ff_8c_afa89348e9fc2de82ae9e12c661366b0e}{DIR\_Name}] = \textcolor{charliteral}{'.'};
3204                 dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] = \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR};
3205                 \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(dir+\hyperlink{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}{DIR\_WrtTime}, tim);
3206                 \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{ST\_CLUST}(dir, dcl);
3207                 mem\_cpy(dir + \hyperlink{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}{SZ\_DIR}, dir, \hyperlink{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}{SZ\_DIR}); \textcolor{comment}{/* Create ".." entry */}
3208                 dir[33] = \textcolor{charliteral}{'.'};
3209                 pcl = dj.\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust};
3210                 \textcolor{keywordflow}{if} (dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aee58d0bf64f06146927e78ad026b06ac}{fs\_type} == \hyperlink{pff_8h_ac63e0796095a789cefdbc3c3c676c9ce}{FS\_FAT32} && pcl == dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->
      \hyperlink{struct_f_a_t_f_s_a2152449dba421b7671f09ec7fcc7fa4e}{dirbase})
3211                     pcl = 0;
3212                 \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{ST\_CLUST}(dir+\hyperlink{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}{SZ\_DIR}, pcl);
3213                 \textcolor{keywordflow}{for} (n = dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize}; n; n--) \{ \textcolor{comment}{/* Write dot entries and clear following sectors */}
3214                     dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} = dsc++;
3215                     dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
3216                     res = move\_window(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0);
3217                     \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3218                         \textcolor{keywordflow}{break};
3219                     mem\_set(dir, 0, \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}));
3220                 \}
3221             \}
3222             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3223                 res = dir\_register(&dj); \textcolor{comment}{/* Register the object to the directoy */}
3224             \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3225                 remove\_chain(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, dcl); \textcolor{comment}{/* Could not register, remove cluster chain */}
3226             \} \textcolor{keywordflow}{else} \{
3227                 dir = dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir};
3228                 dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] = \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR}; \textcolor{comment}{/* Attribute */}
3229                 \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(dir+\hyperlink{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}{DIR\_WrtTime}, tim); \textcolor{comment}{/* Created time */}
3230                 \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{ST\_CLUST}(dir, dcl); \textcolor{comment}{/* Table start cluster */}
3231                 dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
3232                 res = sync(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs});
3233             \}
3234         \}\hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
3235     \}
3236 
3237     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
3238 \}
\end{DoxyCode}
\hypertarget{ff_8c_a3bb9e218b8a853db0871a0fa93a0eae6}{\index{ff.\-c@{ff.\-c}!f\-\_\-mount@{f\-\_\-mount}}
\index{f\-\_\-mount@{f\-\_\-mount}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-mount}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-mount (
\begin{DoxyParamCaption}
\item[{{\bf P\-F\-\_\-\-B\-Y\-T\-E}}]{vol, }
\item[{{\bf F\-A\-T\-F\-S} $\ast$}]{fs}
\end{DoxyParamCaption}
)}}\label{ff_8c_a3bb9e218b8a853db0871a0fa93a0eae6}


Definition at line 2142 of file ff.\-c.



References \-\_\-\-V\-O\-L\-U\-M\-E\-S, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-D\-R\-I\-V\-E, F\-R\-\_\-\-O\-K, and F\-A\-T\-F\-S\-::fs\-\_\-type.


\begin{DoxyCode}
2144   \{
2145     \hyperlink{struct_f_a_t_f_s}{FATFS} *rfs;
2146 
2147     \textcolor{keywordflow}{if} (vol >= \hyperlink{ffconf_8h_a366da9a40c8ceb3103a6b72ca02b9969}{\_VOLUMES}) \{\textcolor{comment}{/* Check if the drive number is valid */}
2148         \textcolor{keywordflow}{return} \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca487844af77de15f6932a3b41ef3a2d65}{FR\_INVALID\_DRIVE};
2149     \}
2150     rfs = FatFs[vol]; \textcolor{comment}{/* Get current fs object */}
2151 
2152     \textcolor{keywordflow}{if} (rfs) \{
2153 \textcolor{preprocessor}{#if \_FS\_SHARE}
2154 \textcolor{preprocessor}{}        clear\_lock(rfs);
2155 \textcolor{preprocessor}{#endif}
2156 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if \_FS\_REENTRANT               }\textcolor{comment}{/* Discard sync object of the current volume */}\textcolor{preprocessor}{}
2157 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (!ff\_del\_syncobj(rfs->sobj)) \textcolor{keywordflow}{return} \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
2158 \textcolor{preprocessor}{#endif}
2159 \textcolor{preprocessor}{}        rfs->\hyperlink{struct_f_a_t_f_s_aee58d0bf64f06146927e78ad026b06ac}{fs\_type} = 0; \textcolor{comment}{/* Clear old fs object */}
2160     \}
2161 
2162     \textcolor{keywordflow}{if} (fs) \{
2163         fs->\hyperlink{struct_f_a_t_f_s_aee58d0bf64f06146927e78ad026b06ac}{fs\_type} = 0; \textcolor{comment}{/* Clear new fs object */}
2164 \textcolor{preprocessor}{#if \_FS\_REENTRANT               }\textcolor{comment}{/* Create sync object for the new volume */}\textcolor{preprocessor}{}
2165 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (!ff\_cre\_syncobj(vol, &fs->sobj)) \textcolor{keywordflow}{return} \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
2166 \textcolor{preprocessor}{#endif}
2167 \textcolor{preprocessor}{}    \}
2168     FatFs[vol] = fs; \textcolor{comment}{/* Register new fs object */}
2169 
2170     \textcolor{keywordflow}{return} \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK};
2171 \}
\end{DoxyCode}
\hypertarget{ff_8c_ab001edb1e8000ce84d9967e616a78ae7}{\index{ff.\-c@{ff.\-c}!f\-\_\-open@{f\-\_\-open}}
\index{f\-\_\-open@{f\-\_\-open}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-open}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-open (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path, }
\item[{{\bf P\-F\-\_\-\-B\-Y\-T\-E}}]{mode}
\end{DoxyParamCaption}
)}}\label{ff_8c_ab001edb1e8000ce84d9967e616a78ae7}


Definition at line 2177 of file ff.\-c.



References A\-M\-\_\-\-D\-I\-R, A\-M\-\_\-\-R\-D\-O, F\-I\-L\-::cltbl, F\-I\-L\-::csect, D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, dir, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-Crt\-Time, D\-I\-R\-\_\-\-File\-Size, D\-I\-R\-\_\-\-Fst\-Clus\-H\-I, D\-I\-R\-\_\-\-Fst\-Clus\-L\-O, D\-I\-R\-\_\-\-Name, D\-I\-R\-\_\-\-N\-Tres, F\-I\-L\-::dir\-\_\-ptr, F\-I\-L\-::dir\-\_\-sect, dj, F\-I\-L\-::dsect, F\-A\-\_\-\-\_\-\-W\-R\-I\-T\-T\-E\-N, F\-A\-\_\-\-C\-R\-E\-A\-T\-E\-\_\-\-A\-L\-W\-A\-Y\-S, F\-A\-\_\-\-C\-R\-E\-A\-T\-E\-\_\-\-N\-E\-W, F\-A\-\_\-\-O\-P\-E\-N\-\_\-\-A\-L\-W\-A\-Y\-S, F\-A\-\_\-\-R\-E\-A\-D, F\-A\-\_\-\-W\-R\-I\-T\-E, F\-I\-L\-::flag, F\-I\-L\-::fptr, F\-R\-\_\-\-D\-E\-N\-I\-E\-D, F\-R\-\_\-\-E\-X\-I\-S\-T, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-R\-\_\-\-T\-O\-O\-\_\-\-M\-A\-N\-Y\-\_\-\-O\-P\-E\-N\-\_\-\-F\-I\-L\-E\-S, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, F\-I\-L\-::fs, F\-I\-L\-::fsize, get\-\_\-fattime(), F\-A\-T\-F\-S\-::id, F\-I\-L\-::id, I\-N\-I\-T\-\_\-\-B\-U\-F, F\-A\-T\-F\-S\-::last\-\_\-clust, L\-D\-\_\-\-C\-L\-U\-S\-T, L\-D\-\_\-\-D\-W\-O\-R\-D, L\-D\-\_\-\-W\-O\-R\-D, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-U\-L\-L, F\-I\-L\-::org\-\_\-clust, res, F\-I\-L\-::sclust, S\-T\-\_\-\-C\-L\-U\-S\-T, S\-T\-\_\-\-D\-W\-O\-R\-D, S\-T\-\_\-\-W\-O\-R\-D, F\-A\-T\-F\-S\-::wflag, F\-A\-T\-F\-S\-::winflag, and F\-A\-T\-F\-S\-::winsect.


\begin{DoxyCode}
2180   \{
2181     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2182     \hyperlink{struct_d_i_r}{DIR} \hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj};
2183     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
2184     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
2185 
2186     fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs} = 0; \textcolor{comment}{/* Clear file object */}
2187 
2188 \textcolor{preprocessor}{#if !\_FS\_READONLY}
2189 \textcolor{preprocessor}{}    mode &= \hyperlink{tff_8h_a1f4f3530ff03abbd979b072536e72290}{FA\_READ} | \hyperlink{tff_8h_afa366963220c89b882c0361794020c14}{FA\_WRITE} | \hyperlink{tff_8h_afba4546b131dea4b24727fa20a80e29f}{FA\_CREATE\_ALWAYS} | 
      \hyperlink{tff_8h_a17b01553029920ac0468912b4bcb16c7}{FA\_OPEN\_ALWAYS}
2190             | \hyperlink{tff_8h_a417bb1babd1785fd181a806b5613eba3}{FA\_CREATE\_NEW};
2191     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) (mode & ~\hyperlink{tff_8h_a1f4f3530ff03abbd979b072536e72290}{FA\_READ}));
2192 \textcolor{preprocessor}{#else}
2193 \textcolor{preprocessor}{}    mode &= \hyperlink{tff_8h_a1f4f3530ff03abbd979b072536e72290}{FA\_READ};
2194     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0);
2195 \textcolor{preprocessor}{#endif}
2196 \textcolor{preprocessor}{}    \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(dj);
2197     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
2198         res = follow\_path(&dj, path); \textcolor{comment}{/* Follow the file path */}
2199     dir = dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir};
2200 
2201 \textcolor{preprocessor}{#if !\_FS\_READONLY   }\textcolor{comment}{/* R/W configuration */}\textcolor{preprocessor}{}
2202 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2203         \textcolor{keywordflow}{if} (!dir) \textcolor{comment}{/* Current dir itself */}
2204             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
2205 \textcolor{preprocessor}{#if \_FS\_SHARE}
2206 \textcolor{preprocessor}{}        \textcolor{keywordflow}{else}
2207         res = chk\_lock(&dj, (mode & ~\hyperlink{tff_8h_a1f4f3530ff03abbd979b072536e72290}{FA\_READ}) ? 1 : 0);
2208 \textcolor{preprocessor}{#endif}
2209 \textcolor{preprocessor}{}    \}
2210     \textcolor{comment}{/* Create or Open a file */}
2211     \textcolor{keywordflow}{if} (mode & (\hyperlink{tff_8h_afba4546b131dea4b24727fa20a80e29f}{FA\_CREATE\_ALWAYS} | \hyperlink{tff_8h_a17b01553029920ac0468912b4bcb16c7}{FA\_OPEN\_ALWAYS} | 
      \hyperlink{tff_8h_a417bb1babd1785fd181a806b5613eba3}{FA\_CREATE\_NEW})) \{
2212         \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} dw, cl;
2213 
2214         \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* No file, create new */}
2215             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE}) \textcolor{comment}{/* There is no file to open, create a new entry */}
2216 \textcolor{preprocessor}{#if \_FS\_SHARE}
2217 \textcolor{preprocessor}{}                res = enq\_lock() ? dir\_register(&dj) : \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44ca50dd3c3c274ccebb2cfbddde9d065bb9}{FR\_TOO\_MANY\_OPEN\_FILES};
2218 \textcolor{preprocessor}{#else}
2219 \textcolor{preprocessor}{}                res = dir\_register(&dj);
2220 \textcolor{preprocessor}{#endif}
2221 \textcolor{preprocessor}{}            mode |= \hyperlink{tff_8h_afba4546b131dea4b24727fa20a80e29f}{FA\_CREATE\_ALWAYS}; \textcolor{comment}{/* File is created */}
2222             dir = dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir}; \textcolor{comment}{/* New entry */}
2223         \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* Any object is already existing */}
2224             \textcolor{keywordflow}{if} (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & (\hyperlink{pff_8h_add6d85d1e7a02b4f6188783ef91a5f1e}{AM\_RDO} | \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR})) \{ \textcolor{comment}{/* Cannot overwrite it (R/O or
       DIR) */}
2225                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED};
2226             \} \textcolor{keywordflow}{else} \{
2227                 \textcolor{keywordflow}{if} (mode & \hyperlink{tff_8h_a417bb1babd1785fd181a806b5613eba3}{FA\_CREATE\_NEW}) \textcolor{comment}{/* Cannot create as new file */}
2228                     res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450}{FR\_EXIST};
2229             \}
2230         \}
2231         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && (mode & \hyperlink{tff_8h_afba4546b131dea4b24727fa20a80e29f}{FA\_CREATE\_ALWAYS})) \{ \textcolor{comment}{/* Truncate it if overwrite
       mode */}
2232             dw = \hyperlink{tff_8h_a489f23a9be58cd896a5c45e45c6e6e6f}{get\_fattime}(); \textcolor{comment}{/* Created time */}
2233             \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(dir+\hyperlink{ff_8c_a47fb1881ea71d860db9b8280564cb4d5}{DIR\_CrtTime}, dw);
2234             dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] = 0; \textcolor{comment}{/* Reset attribute */}
2235             \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(dir+\hyperlink{ff_8c_abfbfa613864a02a65f0bf70ead6672c7}{DIR\_FileSize}, 0); \textcolor{comment}{/* size = 0 */}
2236             cl = \hyperlink{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{LD\_CLUST}(dir); \textcolor{comment}{/* Get start cluster */}
2237             \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{ST\_CLUST}(dir, 0); \textcolor{comment}{/* cluster = 0 */}
2238             dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
2239             \textcolor{keywordflow}{if} (cl) \{ \textcolor{comment}{/* Remove the cluster chain if exist */}
2240                 dw = dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect};
2241                 res = remove\_chain(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, cl);
2242                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2243                     dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a07b2a137b54c6c95ffcee006c8906429}{last\_clust} = cl - 1; \textcolor{comment}{/* Reuse the cluster hole */}
2244                     res = move\_window(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, dw);
2245                 \}
2246             \}
2247         \}
2248     \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* Open an existing file */}
2249         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Follow succeeded */}
2250             \textcolor{keywordflow}{if} (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR}) \{ \textcolor{comment}{/* It is a directory */}
2251                 res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE};
2252             \} \textcolor{keywordflow}{else} \{
2253                 \textcolor{keywordflow}{if} ((mode & \hyperlink{tff_8h_afa366963220c89b882c0361794020c14}{FA\_WRITE}) && (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & \hyperlink{pff_8h_add6d85d1e7a02b4f6188783ef91a5f1e}{AM\_RDO})) \textcolor{comment}{/* R/O violation 
      */}
2254                     res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED};
2255             \}
2256         \}
2257     \}
2258     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2259         \textcolor{keywordflow}{if} (mode & FA\_CREATE\_ALWAYS) \textcolor{comment}{/* Set file change flag if created or overwritten */}
2260             mode |= \hyperlink{tff_8h_ac4b7d5223f84df91c306ffbff536fae4}{FA\_\_WRITTEN};
2261         fp->\hyperlink{struct_f_i_l_ac40d4a51f8f940e6154d364c45935278}{dir\_sect} = dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect}; \textcolor{comment}{/* Pointer to the directory entry */}
2262         fp->\hyperlink{struct_f_i_l_abc0a41dfbb69ffc78a01f5a357412995}{dir\_ptr} = \hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
2263 \textcolor{preprocessor}{#if \_FS\_SHARE}
2264 \textcolor{preprocessor}{}        fp->lockid = inc\_lock(&dj, (mode & ~\hyperlink{tff_8h_a1f4f3530ff03abbd979b072536e72290}{FA\_READ}) ? 1 : 0);
2265         \textcolor{keywordflow}{if} (!fp->lockid) res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
2266 \textcolor{preprocessor}{#endif}
2267 \textcolor{preprocessor}{}    \}
2268 
2269 \textcolor{preprocessor}{#else               }\textcolor{comment}{/* R/O configuration */}\textcolor{preprocessor}{}
2270 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Follow succeeded */}
2271         \textcolor{keywordflow}{if} (!dir) \{ \textcolor{comment}{/* Current dir itself */}
2272             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
2273         \} \textcolor{keywordflow}{else} \{
2274             \textcolor{keywordflow}{if} (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & AM\_DIR) \textcolor{comment}{/* It is a directory */}
2275             res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE};
2276         \}
2277     \}
2278 \textcolor{preprocessor}{#endif}
2279 \textcolor{preprocessor}{}    \hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
2280 
2281     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2282         fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} = mode; \textcolor{comment}{/* File access mode */}
2283         fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust} = \hyperlink{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{LD\_CLUST}(dir); \textcolor{comment}{/* File start cluster */}
2284         fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} = \hyperlink{pff_8h_a4690304ddc975516f7dc02575c96e34e}{LD\_DWORD}(dir+\hyperlink{ff_8c_abfbfa613864a02a65f0bf70ead6672c7}{DIR\_FileSize}); \textcolor{comment}{/* File size */}
2285         fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} = 0; \textcolor{comment}{/* File pointer */}
2286         fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} = 0;
2287 \textcolor{preprocessor}{#if \_USE\_FASTSEEK}
2288 \textcolor{preprocessor}{}        fp->\hyperlink{struct_f_i_l_a807e335a4d92639456ac4273cb0de4cb}{cltbl} = 0; \textcolor{comment}{/* Normal seek mode */}
2289 \textcolor{preprocessor}{#endif}
2290 \textcolor{preprocessor}{}        fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs} = dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs};
2291         fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id} = dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}; \textcolor{comment}{/* Validate file object */}
2292     \}
2293 
2294     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2295 \}
\end{DoxyCode}
\hypertarget{ff_8c_a5a7b44d8858165d18ff5617d81244f35}{\index{ff.\-c@{ff.\-c}!f\-\_\-opendir@{f\-\_\-opendir}}
\index{f\-\_\-opendir@{f\-\_\-opendir}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-opendir}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-opendir (
\begin{DoxyParamCaption}
\item[{{\bf D\-I\-R} $\ast$}]{dj, }
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path}
\end{DoxyParamCaption}
)}}\label{ff_8c_a5a7b44d8858165d18ff5617d81244f35}


Definition at line 2890 of file ff.\-c.



References A\-M\-\_\-\-D\-I\-R, D\-I\-R\-::clust, clust2sect(), D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-Fst\-Clus\-H\-I, D\-I\-R\-\_\-\-Fst\-Clus\-L\-O, F\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, F\-R\-\_\-\-N\-O\-\_\-\-P\-A\-T\-H, F\-R\-\_\-\-O\-K, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, F\-A\-T\-F\-S\-::id, D\-I\-R\-::id, D\-I\-R\-::index, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-D\-\_\-\-C\-L\-U\-S\-T, L\-D\-\_\-\-W\-O\-R\-D, L\-E\-A\-V\-E\-\_\-\-F\-F, res, D\-I\-R\-::sclust, and D\-I\-R\-::sect.


\begin{DoxyCode}
2892   \{
2893     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2894     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
2895 
2896     res = chk\_mounted(&path, &dj->\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0);
2897     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2898         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(*dj);
2899         res = follow\_path(dj, path); \textcolor{comment}{/* Follow the path to the directory */}
2900         \hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
2901         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Follow completed */}
2902             \textcolor{keywordflow}{if} (dj->\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir}) \{ \textcolor{comment}{/* It is not the root dir */}
2903                 \textcolor{keywordflow}{if} (dj->\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir}[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR}) \{ \textcolor{comment}{/* The object is a directory */}
2904                     dj->\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust} = \hyperlink{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{LD\_CLUST}(dj->\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir});
2905                 \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* The object is not a directory */}
2906                     res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532}{FR\_NO\_PATH};
2907                 \}
2908             \}
2909             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2910                 dj->\hyperlink{struct_d_i_r_a588688f55d57bf8a7e8c1d2cf88a3c56}{id} = dj->\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a588688f55d57bf8a7e8c1d2cf88a3c56}{id};
2911                 res = dir\_sdi(dj, 0); \textcolor{comment}{/* Rewind dir */}
2912             \}
2913         \}
2914         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE})
2915             res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44cae4529c8cc8b59783d6efc9ba4f574532}{FR\_NO\_PATH};
2916     \}
2917 
2918     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj->\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2919 \}
\end{DoxyCode}
\hypertarget{ff_8c_ac4c3dcb6869ca252888eebabe39727b3}{\index{ff.\-c@{ff.\-c}!f\-\_\-read@{f\-\_\-read}}
\index{f\-\_\-read@{f\-\_\-read}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-read (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{void $\ast$}]{buff, }
\item[{{\bf U\-I\-N\-T}}]{btr, }
\item[{{\bf U\-I\-N\-T} $\ast$}]{br}
\end{DoxyParamCaption}
)}}\label{ff_8c_ac4c3dcb6869ca252888eebabe39727b3}


Definition at line 2301 of file ff.\-c.



References A\-B\-O\-R\-T, F\-I\-L\-::buf, F\-I\-L\-::cltbl, F\-I\-L\-::clust, clust2sect(), F\-I\-L\-::csect, F\-A\-T\-F\-S\-::csize, F\-I\-L\-::curr\-\_\-clust, disk\-\_\-read(), disk\-\_\-write(), F\-A\-T\-F\-S\-::drv, F\-I\-L\-::dsect, F\-A\-\_\-\-\_\-\-D\-I\-R\-T\-Y, F\-A\-\_\-\-\_\-\-E\-R\-R\-O\-R, F\-A\-\_\-\-R\-E\-A\-D, F\-I\-L\-::flag, F\-I\-L\-::fptr, F\-R\-\_\-\-D\-E\-N\-I\-E\-D, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-I\-L\-::fs, F\-I\-L\-::fsize, get\-\_\-fat(), F\-I\-L\-::id, L\-E\-A\-V\-E\-\_\-\-F\-F, F\-A\-T\-F\-S\-::max\-\_\-clust, F\-I\-L\-::org\-\_\-clust, res, R\-E\-S\-\_\-\-O\-K, F\-I\-L\-::sclust, S\-S, F\-A\-T\-F\-S\-::wflag, F\-A\-T\-F\-S\-::win, and F\-A\-T\-F\-S\-::winsect.


\begin{DoxyCode}
2305   \{
2306     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2307     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} clst, sect, remain;
2308     \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT} rcnt, cc;
2309     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} csect, *rbuff = buff;
2310 
2311     *br = 0; \textcolor{comment}{/* Initialize byte counter */}
2312 
2313     res = validate(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}); \textcolor{comment}{/* Check validity */}
2314     \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
2315         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2316     \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_ad3b47fe8126573b17752a9a242b76b9a}{FA\_\_ERROR}) \textcolor{comment}{/* Aborted file? */}
2317         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2318     \textcolor{keywordflow}{if} (!(fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_a1f4f3530ff03abbd979b072536e72290}{FA\_READ})) \textcolor{comment}{/* Check access mode */}
2319         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED});
2320     remain = fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} - fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr};
2321     \textcolor{keywordflow}{if} (btr > remain)
2322         btr = (\hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT}) remain; \textcolor{comment}{/* Truncate btr by remaining bytes */}
2323 
2324     \textcolor{keywordflow}{for} (; btr; \textcolor{comment}{/* Repeat until all data read */}
2325     rbuff += rcnt, fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} += rcnt, *br += rcnt, btr -= rcnt) \{
2326         \textcolor{keywordflow}{if} ((fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})) == 0) \{ \textcolor{comment}{/* On the sector boundary? */}
2327             csect = (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) & (fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->
      \hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} - 1)); \textcolor{comment}{/* Sector offset in the cluster */}
2328             \textcolor{keywordflow}{if} (!csect) \{ \textcolor{comment}{/* On the cluster boundary? */}
2329                 \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} == 0) \{ \textcolor{comment}{/* On the top of the file? */}
2330                     clst = fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust}; \textcolor{comment}{/* Follow from the origin */}
2331                 \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* Middle or end of the file */}
2332 \textcolor{preprocessor}{#if \_USE\_FASTSEEK}
2333 \textcolor{preprocessor}{}                    \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a807e335a4d92639456ac4273cb0de4cb}{cltbl})
2334                         clst = clmt\_clust(fp, fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr}); \textcolor{comment}{/* Get cluster# from the CLMT */}
2335                     \textcolor{keywordflow}{else}
2336 \textcolor{preprocessor}{#endif}
2337 \textcolor{preprocessor}{}                        clst = \hyperlink{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{get\_fat}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust}); \textcolor{comment}{/* Follow cluster chain on the FAT
       */}
2338                 \}
2339                 \textcolor{keywordflow}{if} (clst < 2)
2340                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2341                 \textcolor{keywordflow}{if} (clst == 0xFFFFFFFF)
2342                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2343                 fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust} = clst; \textcolor{comment}{/* Update current cluster */}
2344             \}
2345             sect = \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust}); \textcolor{comment}{/* Get current sector */}
2346             \textcolor{keywordflow}{if} (!sect)
2347                 \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2348             sect += csect;
2349             cc = btr / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}); \textcolor{comment}{/* When remaining bytes >= sector size, */}
2350             \textcolor{keywordflow}{if} (cc) \{ \textcolor{comment}{/* Read maximum contiguous sectors directly */}
2351                 \textcolor{keywordflow}{if} (csect + cc > fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize}) \textcolor{comment}{/* Clip at cluster boundary */}
2352                     cc = fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} - csect;
2353                 \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a77ba19c0c97a900fac95999446e32308}{disk\_read}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, rbuff, sect, (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) cc) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2354                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2355 \textcolor{preprocessor}{#if !\_FS\_READONLY && \_FS\_MINIMIZE <= 2          }\textcolor{comment}{/* Replace one of the read sectors with cached data if it
       contains a dirty sector */}\textcolor{preprocessor}{}
2356 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if \_FS\_TINY}
2357 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} && fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} - sect < cc)
2358                 mem\_cpy(rbuff + ((fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} - sect) * \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})), fp->
      \hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}, \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}));
2359 \textcolor{preprocessor}{#else}
2360 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} ((fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY}) && fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} - sect < cc)
2361                     mem\_cpy(rbuff + ((fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} - sect) * \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})), fp->
      \hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf},
2362                             \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}));
2363 \textcolor{preprocessor}{#endif}
2364 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif}
2365 \textcolor{preprocessor}{}                rcnt = \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) * cc; \textcolor{comment}{/* Number of bytes transferred */}
2366                 \textcolor{keywordflow}{continue};
2367             \}
2368 \textcolor{preprocessor}{#if !\_FS\_TINY}
2369 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} != sect) \{ \textcolor{comment}{/* Load data sector if not in cache */}
2370 \textcolor{preprocessor}{#if !\_FS\_READONLY}
2371 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY}) \{ \textcolor{comment}{/* Write-back dirty sector cache */}
2372                     \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a7ffe0ccc946550a260d00871c6b636e7}{disk\_write}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, fp->
      \hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}, 1)
2373                             != \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2374                         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2375                     fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2376                 \}
2377 \textcolor{preprocessor}{#endif}
2378 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a77ba19c0c97a900fac95999446e32308}{disk\_read}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, sect, 1) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK}) \textcolor{comment}{/* Fill sector cache */}
2379                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2380             \}
2381 \textcolor{preprocessor}{#endif}
2382 \textcolor{preprocessor}{}            fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} = sect;
2383         \}
2384         rcnt = \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) - (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})); \textcolor{comment}{/* Get partial sector data from sector
       buffer */}
2385         \textcolor{keywordflow}{if} (rcnt > btr)
2386             rcnt = btr;
2387 \textcolor{preprocessor}{#if \_FS\_TINY}
2388 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (move\_window(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect})) \textcolor{comment}{/* Move sector window */}
2389         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2390         mem\_cpy(rbuff, &fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})], rcnt); \textcolor{comment}{/* Pick partial sector */}
2391 \textcolor{preprocessor}{#else}
2392 \textcolor{preprocessor}{}        mem\_cpy(rbuff, &fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}[fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})], rcnt); \textcolor{comment}{/* Pick partial sector */}
2393 \textcolor{preprocessor}{#endif}
2394 \textcolor{preprocessor}{}    \}
2395 
2396     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK});
2397 \}
\end{DoxyCode}
\hypertarget{ff_8c_a329a4cbc309719043e5066031fc844c6}{\index{ff.\-c@{ff.\-c}!f\-\_\-readdir@{f\-\_\-readdir}}
\index{f\-\_\-readdir@{f\-\_\-readdir}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-readdir}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-readdir (
\begin{DoxyParamCaption}
\item[{{\bf D\-I\-R} $\ast$}]{dj, }
\item[{{\bf F\-I\-L\-I\-N\-F\-O} $\ast$}]{fno}
\end{DoxyParamCaption}
)}}\label{ff_8c_a329a4cbc309719043e5066031fc844c6}


Definition at line 2925 of file ff.\-c.



References c, D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-Name, F\-I\-L\-I\-N\-F\-O\-::fname, F\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, D\-I\-R\-::id, if(), D\-I\-R\-::index, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-E\-A\-V\-E\-\_\-\-F\-F, res, D\-I\-R\-::sect, and F\-A\-T\-F\-S\-::win.


\begin{DoxyCode}
2927   \{
2928     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2929     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
2930 
2931     res = validate(dj->\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, dj->\hyperlink{struct_d_i_r_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}); \textcolor{comment}{/* Check validity of the object */}
2932     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2933         \textcolor{keywordflow}{if} (!fno) \{
2934             res = dir\_sdi(dj, 0); \textcolor{comment}{/* Rewind the directory object */}
2935         \} \textcolor{keywordflow}{else} \{
2936             \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(*dj);
2937             res = dir\_read(dj); \textcolor{comment}{/* Read an directory item */}
2938             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE}) \{ \textcolor{comment}{/* Reached end of dir */}
2939                 dj->\hyperlink{struct_d_i_r_aa7c560f325cb4d59f40dc8cf731b6e22}{sect} = 0;
2940                 res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK};
2941             \}
2942             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* A valid entry is found */}
2943                 get\_fileinfo(dj, fno); \textcolor{comment}{/* Get the object information */}
2944                 res = dir\_next(dj, 0); \textcolor{comment}{/* Increment index for next */}
2945                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE}) \{
2946                     dj->\hyperlink{struct_d_i_r_aa7c560f325cb4d59f40dc8cf731b6e22}{sect} = 0;
2947                     res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK};
2948                 \}
2949             \} \hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
2950         \}
2951     \}
2952 
2953     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj->\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2954 \}
\end{DoxyCode}
\hypertarget{ff_8c_aa775b9b024acfeb3a66523cab497d142}{\index{ff.\-c@{ff.\-c}!f\-\_\-rename@{f\-\_\-rename}}
\index{f\-\_\-rename@{f\-\_\-rename}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-rename}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-rename (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path\-\_\-old, }
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path\-\_\-new}
\end{DoxyParamCaption}
)}}\label{ff_8c_aa775b9b024acfeb3a66523cab497d142}


Definition at line 3316 of file ff.\-c.



References \-\_\-\-F\-S\-\_\-\-R\-P\-A\-T\-H, A\-M\-\_\-\-A\-R\-C, A\-M\-\_\-\-D\-I\-R, clust2sect(), D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, dir, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-Name, D\-I\-R\-\_\-\-N\-Tres, F\-A\-T\-F\-S\-::dirbase, D\-I\-R\-::fn, F\-R\-\_\-\-E\-X\-I\-S\-T, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, F\-S\-\_\-\-F\-A\-T32, F\-A\-T\-F\-S\-::fs\-\_\-type, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-D\-\_\-\-C\-L\-U\-S\-T, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-S, res, D\-I\-R\-::sclust, S\-T\-\_\-\-C\-L\-U\-S\-T, S\-Z\-\_\-\-D\-I\-R, F\-A\-T\-F\-S\-::wflag, F\-A\-T\-F\-S\-::win, F\-A\-T\-F\-S\-::winflag, and F\-A\-T\-F\-S\-::winsect.


\begin{DoxyCode}
3318   \{
3319     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
3320     \hyperlink{struct_d_i_r}{DIR} djo, djn;
3321     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} buf[21], *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
3322     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} dw;
3323     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
3324 
3325     res = chk\_mounted(&path\_old, &djo.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 1);
3326     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3327         djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs} = djo.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs};
3328         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(djo);
3329         res = follow\_path(&djo, path\_old); \textcolor{comment}{/* Check old object */}
3330         \textcolor{keywordflow}{if} (\hyperlink{ffconf_8h_a52faf11025401372f71e9d81905b7af4}{\_FS\_RPATH} && res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && (djo.\hyperlink{struct_d_i_r_af5245f40680a50c52ce1028bbe62d9f9}{fn}[\hyperlink{ff_8c_a06c201f90533d5b49cd039c960327968}{NS}] & \hyperlink{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{NS\_DOT}))
3331             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
3332 \textcolor{preprocessor}{#if \_FS\_SHARE}
3333 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) res = chk\_lock(&djo, 2);
3334 \textcolor{preprocessor}{#endif}
3335 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Old object is found */}
3336             \textcolor{keywordflow}{if} (!djo.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir}) \{ \textcolor{comment}{/* Is root dir? */}
3337                 res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE};
3338             \} \textcolor{keywordflow}{else} \{
3339                 mem\_cpy(buf, djo.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir} + \hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}, 21); \textcolor{comment}{/* Save the object information except for
       name */}
3340                 mem\_cpy(&djn, &djo, \textcolor{keyword}{sizeof}(\hyperlink{struct_d_i_r}{DIR})); \textcolor{comment}{/* Check new object */}
3341                 res = follow\_path(&djn, path\_new);
3342                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3343                     res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca0d8f024d256df76e84782b95018a2450}{FR\_EXIST}; \textcolor{comment}{/* The new object name is already existing */}
3344                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE}) \{ \textcolor{comment}{/* Is it a valid path and no name collision? */}
3345                     \textcolor{comment}{/* Start critical section that any interruption or error can cause cross-link */}
3346                     res = dir\_register(&djn); \textcolor{comment}{/* Register the new entry */}
3347                     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3348                         dir = djn.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir}; \textcolor{comment}{/* Copy object information except for name */}
3349                         mem\_cpy(dir + 13, buf + 2, 19);
3350                         dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] = buf[0] | \hyperlink{pff_8h_ae8174d00798e34e7c9e95898cb9e1a09}{AM\_ARC};
3351                         djo.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
3352                         \textcolor{keywordflow}{if} (djo.\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust} != djn.\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust}
3353                                 && (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR})) \{ \textcolor{comment}{/* Update .. entry in the
       directory if needed */}
3354                             dw = \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect}(djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{LD\_CLUST}(dir));
3355                             \textcolor{keywordflow}{if} (!dw) \{
3356                                 res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
3357                             \} \textcolor{keywordflow}{else} \{
3358                                 res = move\_window(djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, dw);
3359                                 dir = djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win} + \hyperlink{ff_8c_ab10c2f2271dbdc132f9a6b9313fc7324}{SZ\_DIR}; \textcolor{comment}{/* .. entry */}
3360                                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && dir[1] == \textcolor{charliteral}{'.'}) \{
3361                                     dw
3362                                             = (djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aee58d0bf64f06146927e78ad026b06ac}{fs\_type} == 
      \hyperlink{pff_8h_ac63e0796095a789cefdbc3c3c676c9ce}{FS\_FAT32}
3363                                                     && djn.\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust}
3364                                                             == djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a2152449dba421b7671f09ec7fcc7fa4e}{dirbase}) ? 0
3365                                                     : djn.\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust};
3366                                     \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{ST\_CLUST}(dir, dw);
3367                                     djn.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
3368                                 \}
3369                             \}
3370                         \}
3371                         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3372                             res = dir\_remove(&djo); \textcolor{comment}{/* Remove old entry */}
3373                             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3374                                 res = sync(djo.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs});
3375                         \}
3376                     \}
3377                     \textcolor{comment}{/* End critical section */}
3378                 \}
3379             \}
3380         \}\hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
3381     \}
3382     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(djo.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
3383 \}
\end{DoxyCode}
\hypertarget{ff_8c_abe1f60daab5c7d11170c334fb832c798}{\index{ff.\-c@{ff.\-c}!f\-\_\-stat@{f\-\_\-stat}}
\index{f\-\_\-stat@{f\-\_\-stat}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-stat}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-stat (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path, }
\item[{{\bf F\-I\-L\-I\-N\-F\-O} $\ast$}]{fno}
\end{DoxyParamCaption}
)}}\label{ff_8c_abe1f60daab5c7d11170c334fb832c798}


Definition at line 2961 of file ff.\-c.



References D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, D\-I\-R\-::dir, dj, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-O\-K, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-E\-A\-V\-E\-\_\-\-F\-F, and res.


\begin{DoxyCode}
2963   \{
2964     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2965     \hyperlink{struct_d_i_r}{DIR} \hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj};
2966     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
2967 
2968     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0);
2969     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2970         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(dj);
2971         res = follow\_path(&dj, path); \textcolor{comment}{/* Follow the file path */}
2972         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* Follow completed */}
2973             \textcolor{keywordflow}{if} (dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir}) \textcolor{comment}{/* Found an object */}
2974                 get\_fileinfo(&dj, fno);
2975             \textcolor{keywordflow}{else}
2976                 \textcolor{comment}{/* It is root dir */}
2977                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
2978         \}\hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
2979     \}
2980 
2981     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2982 \}
\end{DoxyCode}
\hypertarget{ff_8c_ad69c7246b122ba56a134939ee0eaf847}{\index{ff.\-c@{ff.\-c}!f\-\_\-sync@{f\-\_\-sync}}
\index{f\-\_\-sync@{f\-\_\-sync}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-sync}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-sync (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp}
\end{DoxyParamCaption}
)}}\label{ff_8c_ad69c7246b122ba56a134939ee0eaf847}


Definition at line 2527 of file ff.\-c.



References A\-M\-\_\-\-A\-R\-C, F\-I\-L\-::buf, dir, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-File\-Size, D\-I\-R\-\_\-\-Fst\-Clus\-H\-I, D\-I\-R\-\_\-\-Fst\-Clus\-L\-O, F\-I\-L\-::dir\-\_\-ptr, F\-I\-L\-::dir\-\_\-sect, D\-I\-R\-\_\-\-Wrt\-Time, disk\-\_\-write(), F\-A\-T\-F\-S\-::drv, F\-I\-L\-::dsect, F\-A\-\_\-\-\_\-\-D\-I\-R\-T\-Y, F\-A\-\_\-\-\_\-\-W\-R\-I\-T\-T\-E\-N, F\-I\-L\-::flag, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-I\-L\-::fs, F\-I\-L\-::fsize, get\-\_\-fattime(), F\-I\-L\-::id, L\-E\-A\-V\-E\-\_\-\-F\-F, F\-I\-L\-::org\-\_\-clust, res, R\-E\-S\-\_\-\-O\-K, F\-I\-L\-::sclust, S\-T\-\_\-\-C\-L\-U\-S\-T, S\-T\-\_\-\-D\-W\-O\-R\-D, S\-T\-\_\-\-W\-O\-R\-D, and F\-A\-T\-F\-S\-::wflag.



Referenced by f\-\_\-close().


\begin{DoxyCode}
2528   \{
2529     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2530     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} tim;
2531     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
2532 
2533     res = validate(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}); \textcolor{comment}{/* Check validity of the object */}
2534     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2535         \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_ac4b7d5223f84df91c306ffbff536fae4}{FA\_\_WRITTEN}) \{ \textcolor{comment}{/* Has the file been written? */}
2536 \textcolor{preprocessor}{#if !\_FS\_TINY   }\textcolor{comment}{/* Write-back dirty buffer */}\textcolor{preprocessor}{}
2537 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY}) \{
2538                 \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a7ffe0ccc946550a260d00871c6b636e7}{disk\_write}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}, 1) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2539                     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2540                 fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2541             \}
2542 \textcolor{preprocessor}{#endif}
2543 \textcolor{preprocessor}{}            \textcolor{comment}{/* Update the directory entry */}
2544             res = move\_window(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac40d4a51f8f940e6154d364c45935278}{dir\_sect});
2545             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
2546                 dir = fp->\hyperlink{struct_f_i_l_abc0a41dfbb69ffc78a01f5a357412995}{dir\_ptr};
2547                 dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] |= \hyperlink{pff_8h_ae8174d00798e34e7c9e95898cb9e1a09}{AM\_ARC}; \textcolor{comment}{/* Set archive bit */}
2548                 \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(dir+\hyperlink{ff_8c_abfbfa613864a02a65f0bf70ead6672c7}{DIR\_FileSize}, fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize}); \textcolor{comment}{/* Update file size */}
2549                 \hyperlink{ff_8c_a08174fa72222a48a5c9e5de70c341af7}{ST\_CLUST}(dir, fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust}); \textcolor{comment}{/* Update start cluster */}
2550                 tim = \hyperlink{tff_8h_a489f23a9be58cd896a5c45e45c6e6e6f}{get\_fattime}(); \textcolor{comment}{/* Update updated time */}
2551                 \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(dir+\hyperlink{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}{DIR\_WrtTime}, tim);
2552                 fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{tff_8h_ac4b7d5223f84df91c306ffbff536fae4}{FA\_\_WRITTEN};
2553                 fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
2554                 res = sync(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs});
2555             \}
2556         \}
2557     \}
2558 
2559     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2560 \}
\end{DoxyCode}
\hypertarget{ff_8c_a691a27b40c348f7c84b42e911636f38a}{\index{ff.\-c@{ff.\-c}!f\-\_\-truncate@{f\-\_\-truncate}}
\index{f\-\_\-truncate@{f\-\_\-truncate}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-truncate}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-truncate (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp}
\end{DoxyParamCaption}
)}}\label{ff_8c_a691a27b40c348f7c84b42e911636f38a}


Definition at line 3062 of file ff.\-c.



References F\-I\-L\-::clust, F\-I\-L\-::curr\-\_\-clust, F\-A\-\_\-\-\_\-\-E\-R\-R\-O\-R, F\-A\-\_\-\-\_\-\-W\-R\-I\-T\-T\-E\-N, F\-A\-\_\-\-W\-R\-I\-T\-E, F\-I\-L\-::flag, F\-I\-L\-::fptr, F\-R\-\_\-\-D\-E\-N\-I\-E\-D, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-I\-L\-::fs, F\-I\-L\-::fsize, get\-\_\-fat(), F\-I\-L\-::id, L\-E\-A\-V\-E\-\_\-\-F\-F, F\-A\-T\-F\-S\-::max\-\_\-clust, F\-A\-T\-F\-S\-::n\-\_\-fatent, F\-I\-L\-::org\-\_\-clust, put\-\_\-fat(), res, and F\-I\-L\-::sclust.


\begin{DoxyCode}
3063   \{
3064     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
3065     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} ncl;
3066 
3067     res = validate(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}); \textcolor{comment}{/* Check validity of the object */}
3068     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3069         \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_ad3b47fe8126573b17752a9a242b76b9a}{FA\_\_ERROR}) \{ \textcolor{comment}{/* Check abort flag */}
3070             res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
3071         \} \textcolor{keywordflow}{else} \{
3072             \textcolor{keywordflow}{if} (!(fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_afa366963220c89b882c0361794020c14}{FA\_WRITE})) \textcolor{comment}{/* Check access mode */}
3073                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED};
3074         \}
3075     \}
3076     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3077         \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} > fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr}) \{
3078             fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} = fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr}; \textcolor{comment}{/* Set file size to current R/W point */}
3079             fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} |= \hyperlink{tff_8h_ac4b7d5223f84df91c306ffbff536fae4}{FA\_\_WRITTEN};
3080             \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} == 0) \{ \textcolor{comment}{/* When set file size to zero, remove entire cluster chain */}
3081                 res = remove\_chain(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust});
3082                 fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust} = 0;
3083             \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* When truncate a part of the file, remove remaining clusters */}
3084                 ncl = \hyperlink{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{get\_fat}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust});
3085                 res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK};
3086                 \textcolor{keywordflow}{if} (ncl == 0xFFFFFFFF)
3087                     res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR};
3088                 \textcolor{keywordflow}{if} (ncl == 1)
3089                     res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
3090                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && ncl < fp->fs->n\_fatent) \{
3091                     res = \hyperlink{ff_8c_abd4b6b071a8d728a88727051c12bc6d7}{put\_fat}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust}, 0x0FFFFFFF);
3092                     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3093                         res = remove\_chain(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, ncl);
3094                 \}
3095             \}
3096         \}
3097         \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3098             fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} |= \hyperlink{tff_8h_ad3b47fe8126573b17752a9a242b76b9a}{FA\_\_ERROR};
3099     \}
3100 
3101     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
3102 \}
\end{DoxyCode}
\hypertarget{ff_8c_a2858167fcd0bced48e9be434b3895efe}{\index{ff.\-c@{ff.\-c}!f\-\_\-unlink@{f\-\_\-unlink}}
\index{f\-\_\-unlink@{f\-\_\-unlink}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-unlink}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-unlink (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path}
\end{DoxyParamCaption}
)}}\label{ff_8c_a2858167fcd0bced48e9be434b3895efe}


Definition at line 3108 of file ff.\-c.



References \-\_\-\-F\-S\-\_\-\-R\-P\-A\-T\-H, A\-M\-\_\-\-D\-I\-R, A\-M\-\_\-\-R\-D\-O, D\-I\-R\-::clust, clust2sect(), D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, dir, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Attr, D\-I\-R\-\_\-\-Fst\-Clus\-H\-I, D\-I\-R\-\_\-\-Fst\-Clus\-L\-O, D\-I\-R\-\_\-\-Name, dj, D\-I\-R\-::fn, F\-R\-\_\-\-D\-E\-N\-I\-E\-D, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-N\-O\-\_\-\-F\-I\-L\-E, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, D\-I\-R\-::index, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-D\-\_\-\-C\-L\-U\-S\-T, L\-D\-\_\-\-W\-O\-R\-D, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-S, res, D\-I\-R\-::sclust, D\-I\-R\-::sect, F\-A\-T\-F\-S\-::win, F\-A\-T\-F\-S\-::winflag, and F\-A\-T\-F\-S\-::winsect.


\begin{DoxyCode}
3109   \{
3110     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
3111     \hyperlink{struct_d_i_r}{DIR} \hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj}, sdj;
3112     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
3113     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} dclst;
3114     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
3115 
3116     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 1);
3117     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3118         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(dj);
3119         res = follow\_path(&dj, path); \textcolor{comment}{/* Follow the file path */}
3120         \textcolor{keywordflow}{if} (\hyperlink{ffconf_8h_a52faf11025401372f71e9d81905b7af4}{\_FS\_RPATH} && res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && (dj.\hyperlink{struct_d_i_r_af5245f40680a50c52ce1028bbe62d9f9}{fn}[\hyperlink{ff_8c_a06c201f90533d5b49cd039c960327968}{NS}] & \hyperlink{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{NS\_DOT}))
3121             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME}; \textcolor{comment}{/* Cannot remove dot entry */}
3122 \textcolor{preprocessor}{#if \_FS\_SHARE}
3123 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) res = chk\_lock(&dj, 2); \textcolor{comment}{/* Cannot remove open file */}
3124 \textcolor{preprocessor}{#endif}
3125 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{ \textcolor{comment}{/* The object is accessible */}
3126             dir = dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir};
3127             \textcolor{keywordflow}{if} (!dir) \{
3128                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME}; \textcolor{comment}{/* Cannot remove the start directory */}
3129             \} \textcolor{keywordflow}{else} \{
3130                 \textcolor{keywordflow}{if} (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & \hyperlink{pff_8h_add6d85d1e7a02b4f6188783ef91a5f1e}{AM\_RDO})
3131                     res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED}; \textcolor{comment}{/* Cannot remove R/O object */}
3132             \}
3133             dclst = \hyperlink{ff_8c_a19cd426084600d6007eb6f976c81fbdf}{LD\_CLUST}(dir);
3134             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && (dir[\hyperlink{ff_8c_ad3233e40118ed66095f3c9545b788f8a}{DIR\_Attr}] & \hyperlink{pff_8h_a3a9db44e978ed6c13b641e092d4cd7d3}{AM\_DIR})) \{ \textcolor{comment}{/* Is it a sub-dir? */}
3135                 \textcolor{keywordflow}{if} (dclst < 2) \{
3136                     res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
3137                 \} \textcolor{keywordflow}{else} \{
3138                     mem\_cpy(&sdj, &dj, \textcolor{keyword}{sizeof}(\hyperlink{struct_d_i_r}{DIR})); \textcolor{comment}{/* Check if the sub-dir is empty or not */}
3139                     sdj.\hyperlink{struct_d_i_r_aada1acd6ce100ead798e712b18c49547}{sclust} = dclst;
3140                     res = dir\_sdi(&sdj, 2); \textcolor{comment}{/* Exclude dot entries */}
3141                     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3142                         res = dir\_read(&sdj);
3143                         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} \textcolor{comment}{/* Not empty dir */}
3144 #\textcolor{keywordflow}{if} \hyperlink{ffconf_8h_a52faf11025401372f71e9d81905b7af4}{\_FS\_RPATH}
3145                             || dclst == sdj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->cdir \textcolor{comment}{/* Current dir */}
3146 #endif
3147                             ) res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED};
3148                         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97da8f98fc2e66d8fa7847f9ebb19b8c}{FR\_NO\_FILE})
3149                             res = \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}; \textcolor{comment}{/* Empty */}
3150                     \}
3151                 \}
3152             \}
3153             \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3154                 res = dir\_remove(&dj); \textcolor{comment}{/* Remove the directory entry */}
3155                 \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3156                     \textcolor{keywordflow}{if} (dclst) \textcolor{comment}{/* Remove the cluster chain if exist */}
3157                         res = remove\_chain(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, dclst);
3158                     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
3159                         res = sync(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs});
3160                 \}
3161             \}
3162         \}\hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
3163     \}
3164     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
3165 \}
\end{DoxyCode}
\hypertarget{ff_8c_aafaa718d1a487e12a8f0087173dba0b9}{\index{ff.\-c@{ff.\-c}!f\-\_\-utime@{f\-\_\-utime}}
\index{f\-\_\-utime@{f\-\_\-utime}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-utime}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-utime (
\begin{DoxyParamCaption}
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path, }
\item[{const {\bf F\-I\-L\-I\-N\-F\-O} $\ast$}]{fno}
\end{DoxyParamCaption}
)}}\label{ff_8c_aafaa718d1a487e12a8f0087173dba0b9}


Definition at line 3281 of file ff.\-c.



References \-\_\-\-F\-S\-\_\-\-R\-P\-A\-T\-H, D\-E\-F\-\_\-\-N\-A\-M\-E\-B\-U\-F, dir, D\-I\-R\-::dir, D\-I\-R\-\_\-\-Wrt\-Date, D\-I\-R\-\_\-\-Wrt\-Time, dj, F\-I\-L\-I\-N\-F\-O\-::fdate, D\-I\-R\-::fn, F\-R\-\_\-\-I\-N\-V\-A\-L\-I\-D\-\_\-\-N\-A\-M\-E, F\-R\-\_\-\-O\-K, F\-R\-E\-E\-\_\-\-B\-U\-F, D\-I\-R\-::fs, F\-I\-L\-I\-N\-F\-O\-::ftime, I\-N\-I\-T\-\_\-\-B\-U\-F, L\-E\-A\-V\-E\-\_\-\-F\-F, N\-S, res, S\-T\-\_\-\-W\-O\-R\-D, and F\-A\-T\-F\-S\-::wflag.


\begin{DoxyCode}
3283   \{
3284     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
3285     \hyperlink{struct_d_i_r}{DIR} \hyperlink{tff_8c_a90affc32512431e143844fa9721bf9d9}{dj};
3286     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *\hyperlink{tff_8c_addeee88e846cc637a785bcaf23b45b5e}{dir};
3287     \hyperlink{ff_8c_a40aba328871d2be78bfdd74b390275db}{DEF\_NAMEBUF};
3288 
3289     res = chk\_mounted(&path, &dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, 1);
3290     \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3291         \hyperlink{ff_8c_a966fe5792671b39db1ccf655a8c1af8d}{INIT\_BUF}(dj);
3292         res = follow\_path(&dj, path); \textcolor{comment}{/* Follow the file path */}
3293         \hyperlink{ff_8c_aba6d6942b59f11cf285bdbfb7e38f1fa}{FREE\_BUF}();
3294         \textcolor{keywordflow}{if} (\hyperlink{ffconf_8h_a52faf11025401372f71e9d81905b7af4}{\_FS\_RPATH} && res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK} && (dj.\hyperlink{struct_d_i_r_af5245f40680a50c52ce1028bbe62d9f9}{fn}[\hyperlink{ff_8c_a06c201f90533d5b49cd039c960327968}{NS}] & \hyperlink{ff_8c_a2db528782a021797b34bdc6e9e9de1c3}{NS\_DOT}))
3295             res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
3296         \textcolor{keywordflow}{if} (res == \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK}) \{
3297             dir = dj.\hyperlink{struct_d_i_r_ab9e26ba9262ce0f12d043d71dd4b2cf5}{dir};
3298             \textcolor{keywordflow}{if} (!dir) \{ \textcolor{comment}{/* Root directory */}
3299                 res = \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca83e45a4b579558c57192c0a391b9bb45}{FR\_INVALID\_NAME};
3300             \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* File or sub-directory */}
3301                 \hyperlink{pff_8h_a95ceb4c25b216e71baa7102939edfd0d}{ST\_WORD}(dir+\hyperlink{ff_8c_ab9452d336adeece2a1b0b54ab35b8a59}{DIR\_WrtTime}, fno->\hyperlink{struct_f_i_l_i_n_f_o_a3f6ad56d9c47d7ca879332e034917077}{ftime});
3302                 \hyperlink{pff_8h_a95ceb4c25b216e71baa7102939edfd0d}{ST\_WORD}(dir+\hyperlink{ff_8c_abed17fa699511b09cbf64961373d63a4}{DIR\_WrtDate}, fno->\hyperlink{struct_f_i_l_i_n_f_o_a9478c5225c4f3a09d739dbc2245a72fd}{fdate});
3303                 dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
3304                 res = sync(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs});
3305             \}
3306         \}
3307     \}
3308 
3309     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(dj.\hyperlink{struct_d_i_r_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
3310 \}
\end{DoxyCode}
\hypertarget{ff_8c_ae6a4dfae8a9e308bdb2283a37ef680f2}{\index{ff.\-c@{ff.\-c}!f\-\_\-write@{f\-\_\-write}}
\index{f\-\_\-write@{f\-\_\-write}!ff.c@{ff.\-c}}
\subsubsection[{f\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} f\-\_\-write (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{const void $\ast$}]{buff, }
\item[{{\bf U\-I\-N\-T}}]{btw, }
\item[{{\bf U\-I\-N\-T} $\ast$}]{bw}
\end{DoxyParamCaption}
)}}\label{ff_8c_ae6a4dfae8a9e308bdb2283a37ef680f2}


Definition at line 2404 of file ff.\-c.



References A\-B\-O\-R\-T, F\-I\-L\-::buf, F\-I\-L\-::cltbl, F\-I\-L\-::clust, clust2sect(), F\-I\-L\-::csect, F\-A\-T\-F\-S\-::csize, F\-I\-L\-::curr\-\_\-clust, disk\-\_\-read(), disk\-\_\-write(), F\-A\-T\-F\-S\-::drv, F\-I\-L\-::dsect, F\-A\-\_\-\-\_\-\-D\-I\-R\-T\-Y, F\-A\-\_\-\-\_\-\-E\-R\-R\-O\-R, F\-A\-\_\-\-\_\-\-W\-R\-I\-T\-T\-E\-N, F\-A\-\_\-\-W\-R\-I\-T\-E, F\-I\-L\-::flag, F\-I\-L\-::fptr, F\-R\-\_\-\-D\-E\-N\-I\-E\-D, F\-R\-\_\-\-D\-I\-S\-K\-\_\-\-E\-R\-R, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-O\-K, F\-R\-\_\-\-R\-W\-\_\-\-E\-R\-R\-O\-R, F\-I\-L\-::fs, F\-I\-L\-::fsize, fsize, F\-I\-L\-::id, L\-E\-A\-V\-E\-\_\-\-F\-F, F\-A\-T\-F\-S\-::max\-\_\-clust, F\-I\-L\-::org\-\_\-clust, res, R\-E\-S\-\_\-\-O\-K, F\-I\-L\-::sclust, S\-S, F\-A\-T\-F\-S\-::wflag, F\-A\-T\-F\-S\-::win, F\-A\-T\-F\-S\-::winflag, and F\-A\-T\-F\-S\-::winsect.


\begin{DoxyCode}
2408   \{
2409     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
2410     \hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD} clst, sect;
2411     \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT} wcnt, cc;
2412     \textcolor{keyword}{const} \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *wbuff = buff;
2413     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} csect;
2414 
2415     *bw = 0; \textcolor{comment}{/* Initialize byte counter */}
2416 
2417     res = validate(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a588688f55d57bf8a7e8c1d2cf88a3c56}{id}); \textcolor{comment}{/* Check validity */}
2418     \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
2419         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, res);
2420     \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_ad3b47fe8126573b17752a9a242b76b9a}{FA\_\_ERROR}) \textcolor{comment}{/* Aborted file? */}
2421         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2422     \textcolor{keywordflow}{if} (!(fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{tff_8h_afa366963220c89b882c0361794020c14}{FA\_WRITE})) \textcolor{comment}{/* Check access mode */}
2423         \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{tff_8h_a49d0171ecbd362cda5680a0d360db44ca897e9f2dd7629a80f48af242d8bc1a3d}{FR\_DENIED});
2424     \textcolor{keywordflow}{if} ((\hyperlink{p8_2pinguino_2libraries_2integer_8h_ad342ac907eb044443153a22f964bf0af}{DWORD}) (fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} + btw) < fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize})
2425         btw = 0; \textcolor{comment}{/* File size cannot reach 4GB */}
2426 
2427     \textcolor{keywordflow}{for} (; btw; \textcolor{comment}{/* Repeat until all data written */}
2428     wbuff += wcnt, fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} += wcnt, *bw += wcnt, btw -= wcnt) \{
2429         \textcolor{keywordflow}{if} ((fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})) == 0) \{ \textcolor{comment}{/* On the sector boundary? */}
2430             csect = (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) & (fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->
      \hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} - 1)); \textcolor{comment}{/* Sector offset in the cluster */}
2431             \textcolor{keywordflow}{if} (!csect) \{ \textcolor{comment}{/* On the cluster boundary? */}
2432                 \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} == 0) \{ \textcolor{comment}{/* On the top of the file? */}
2433                     clst = fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust}; \textcolor{comment}{/* Follow from the origin */}
2434                     \textcolor{keywordflow}{if} (clst == 0) \textcolor{comment}{/* When no cluster is allocated, */}
2435                         fp->\hyperlink{struct_f_i_l_ad5d52f3fde971d2a05ff777a6243c252}{sclust} = clst = create\_chain(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0); \textcolor{comment}{/* Create a new cluster chain 
      */}
2436                 \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* Middle or end of the file */}
2437 \textcolor{preprocessor}{#if \_USE\_FASTSEEK}
2438 \textcolor{preprocessor}{}                    \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a807e335a4d92639456ac4273cb0de4cb}{cltbl})
2439                         clst = clmt\_clust(fp, fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr}); \textcolor{comment}{/* Get cluster# from the CLMT */}
2440                     \textcolor{keywordflow}{else}
2441 \textcolor{preprocessor}{#endif}
2442 \textcolor{preprocessor}{}                        clst = create\_chain(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust}); \textcolor{comment}{/* Follow or stretch cluster chain
       on the FAT */}
2443                 \}
2444                 \textcolor{keywordflow}{if} (clst == 0)
2445                     \textcolor{keywordflow}{break}; \textcolor{comment}{/* Could not allocate a new cluster (disk full) */}
2446                 \textcolor{keywordflow}{if} (clst == 1)
2447                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2448                 \textcolor{keywordflow}{if} (clst == 0xFFFFFFFF)
2449                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2450                 fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust} = clst; \textcolor{comment}{/* Update current cluster */}
2451             \}
2452 \textcolor{preprocessor}{#if \_FS\_TINY}
2453 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} == fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} && move\_window(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0)) \textcolor{comment}{/* Write-back
       sector cache */}
2454             \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2455 \textcolor{preprocessor}{#else}
2456 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} & \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY}) \{ \textcolor{comment}{/* Write-back sector cache */}
2457                 \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a7ffe0ccc946550a260d00871c6b636e7}{disk\_write}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect}, 1) != 
      \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2458                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2459                 fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2460             \}
2461 \textcolor{preprocessor}{#endif}
2462 \textcolor{preprocessor}{}            sect = \hyperlink{ff_8c_a7519abb60fe91f6aa1d17f64fbae123a}{clust2sect}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_ac134c1b4645be670eb5207032e714616}{clust}); \textcolor{comment}{/* Get current sector */}
2463             \textcolor{keywordflow}{if} (!sect)
2464                 \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR});
2465             sect += csect;
2466             cc = btw / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}); \textcolor{comment}{/* When remaining bytes >= sector size, */}
2467             \textcolor{keywordflow}{if} (cc) \{ \textcolor{comment}{/* Write maximum contiguous sectors directly */}
2468                 \textcolor{keywordflow}{if} (csect + cc > fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize}) \textcolor{comment}{/* Clip at cluster boundary */}
2469                     cc = fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_af8143a50ac7be72544022dd46a7013da}{csize} - csect;
2470                 \textcolor{keywordflow}{if} (\hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a7ffe0ccc946550a260d00871c6b636e7}{disk\_write}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, wbuff, sect, (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) cc)
2471                         != \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2472                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2473 \textcolor{preprocessor}{#if \_FS\_TINY}
2474 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} - sect < cc) \{ \textcolor{comment}{/* Refill sector cache if it gets invalidated
       by the direct write */}
2475                     mem\_cpy(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}, wbuff + ((fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} - sect) * 
      \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})), \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}));
2476                     fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 0;
2477                 \}
2478 \textcolor{preprocessor}{#else}
2479 \textcolor{preprocessor}{}                \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} - sect < cc) \{ \textcolor{comment}{/* Refill sector cache if it gets invalidated by the
       direct write */}
2480                     mem\_cpy(fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}, wbuff + ((fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} - sect) * \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->
      \hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})),
2481                             \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}));
2482                     fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} &= ~\hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2483                 \}
2484 \textcolor{preprocessor}{#endif}
2485 \textcolor{preprocessor}{}                wcnt = \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) * cc; \textcolor{comment}{/* Number of bytes transferred */}
2486                 \textcolor{keywordflow}{continue};
2487             \}
2488 \textcolor{preprocessor}{#if \_FS\_TINY}
2489 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} >= fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize}) \{ \textcolor{comment}{/* Avoid silly cache filling at growing edge */}
2490                 \textcolor{keywordflow}{if} (move\_window(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, 0)) \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2491                 fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a5ee19a26d1dfd79d52fbba59cc792da3}{winsect} = sect;
2492             \}
2493 \textcolor{preprocessor}{#else}
2494 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} != sect) \{ \textcolor{comment}{/* Fill sector cache with file data */}
2495                 \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} < fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} && \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_a77ba19c0c97a900fac95999446e32308}{disk\_read}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->
      \hyperlink{struct_f_a_t_f_s_aabcebc0763f1acbd8928158570150c9f}{drv}, fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf},
2496                         sect, 1) != \hyperlink{p8_2pinguino_2libraries_2sd_2diskio_8h_aacdfef1dad6565f65c26d12fe0ea4b2ba2ea4b6ef3fffc17dd1d38ab5c2837737}{RES\_OK})
2497                     \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2498             \}
2499 \textcolor{preprocessor}{#endif}
2500 \textcolor{preprocessor}{}            fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect} = sect;
2501         \}
2502         wcnt = \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}) - (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}));\textcolor{comment}{/* Put partial sector into file I/O buffer 
      */}
2503         \textcolor{keywordflow}{if} (wcnt > btw)
2504             wcnt = btw;
2505 \textcolor{preprocessor}{#if \_FS\_TINY}
2506 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (move\_window(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, fp->\hyperlink{struct_f_i_l_a272171f74215002aba31a89428f1d290}{dsect})) \textcolor{comment}{/* Move sector window */}
2507         \hyperlink{ff_8c_a41e4c46636679236568cf50b5535847f}{ABORT}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca97dee4a6b485dc8f91f37486092dfe34}{FR\_DISK\_ERR});
2508         mem\_cpy(&fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})], wbuff, wcnt); \textcolor{comment}{/* Fit partial sector */}
2509         fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
2510 \textcolor{preprocessor}{#else}
2511 \textcolor{preprocessor}{}        mem\_cpy(&fp->\hyperlink{struct_f_i_l_a8b83239f9e2ae594c0cbc75d23ddff89}{buf}[fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs})], wbuff, wcnt); \textcolor{comment}{/* Fit partial sector */}
2512         fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} |= \hyperlink{ff_8h_a5b2962e3616a1e9eb709d95f4c75c67c}{FA\_\_DIRTY};
2513 \textcolor{preprocessor}{#endif}
2514 \textcolor{preprocessor}{}    \}
2515 
2516     \textcolor{keywordflow}{if} (fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr} > fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize})
2517         fp->\hyperlink{struct_f_i_l_a7582a0b3a658c0543f6cdc7585d84f7c}{fsize} = fp->\hyperlink{struct_f_i_l_a5afdaf3451d484cc97e07228b775ccf1}{fptr}; \textcolor{comment}{/* Update file size if needed */}
2518     fp->\hyperlink{struct_f_i_l_ae84669505a47c55d6246560a290a298d}{flag} |= \hyperlink{tff_8h_ac4b7d5223f84df91c306ffbff536fae4}{FA\_\_WRITTEN}; \textcolor{comment}{/* Set file change flag */}
2519 
2520     \hyperlink{ff_8c_a7e653d8ca0ae09faa49cd5b7335fea84}{LEAVE\_FF}(fp->\hyperlink{struct_f_i_l_a472e3612956e3ffb3ab823c37ca33250}{fs}, \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK});
2521 \}
\end{DoxyCode}
\hypertarget{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}{\index{ff.\-c@{ff.\-c}!get\-\_\-fat@{get\-\_\-fat}}
\index{get\-\_\-fat@{get\-\_\-fat}!ff.c@{ff.\-c}}
\subsubsection[{get\-\_\-fat}]{\setlength{\rightskip}{0pt plus 5cm}{\bf D\-W\-O\-R\-D} get\-\_\-fat (
\begin{DoxyParamCaption}
\item[{{\bf F\-A\-T\-F\-S} $\ast$}]{fs, }
\item[{{\bf D\-W\-O\-R\-D}}]{clst}
\end{DoxyParamCaption}
)}}\label{ff_8c_a65611adf1626e5e08da77cd33a98dd8b}


Definition at line 778 of file ff.\-c.



References F\-A\-T\-F\-S\-::fatbase, F\-S\-\_\-\-F\-A\-T12, F\-S\-\_\-\-F\-A\-T16, F\-S\-\_\-\-F\-A\-T32, F\-A\-T\-F\-S\-::fs\-\_\-type, L\-D\-\_\-\-D\-W\-O\-R\-D, L\-D\-\_\-\-W\-O\-R\-D, F\-A\-T\-F\-S\-::n\-\_\-fatent, S\-S, and F\-A\-T\-F\-S\-::win.



Referenced by f\-\_\-getfree(), f\-\_\-lseek(), f\-\_\-read(), and f\-\_\-truncate().


\begin{DoxyCode}
781   \{
782     \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT} wc, bc;
783     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *p;
784 
785     \textcolor{keywordflow}{if} (clst < 2 || clst >= fs->\hyperlink{struct_f_a_t_f_s_a388eb0fa0f3f1449a6ab88c6674e16fc}{n\_fatent}) \textcolor{comment}{/* Chack range */}
786         \textcolor{keywordflow}{return} 1;
787 
788     \textcolor{keywordflow}{switch} (fs->\hyperlink{struct_f_a_t_f_s_aee58d0bf64f06146927e78ad026b06ac}{fs\_type}) \{
789     \textcolor{keywordflow}{case} \hyperlink{pff_8h_aab755aa1b4f81f4aabee4a5d4738cfb0}{FS\_FAT12}:
790         bc = (\hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT}) clst;
791         bc += bc / 2;
792         \textcolor{keywordflow}{if} (move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (bc / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs))))
793             \textcolor{keywordflow}{break};
794         wc = fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[bc % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
795         bc++;
796         \textcolor{keywordflow}{if} (move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (bc / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs))))
797             \textcolor{keywordflow}{break};
798         wc |= fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[bc % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)] << 8;
799         \textcolor{keywordflow}{return} (clst & 1) ? (wc >> 4) : (wc & 0xFFF);
800 
801     \textcolor{keywordflow}{case} \hyperlink{pff_8h_a7ef90a36d99edfc0138a2155a17a79b9}{FS\_FAT16}:
802         \textcolor{keywordflow}{if} (move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (clst / (\hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs) / 2))))
803             \textcolor{keywordflow}{break};
804         p = &fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[clst * 2 % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
805         \textcolor{keywordflow}{return} \hyperlink{pff_8h_a398519bb08da6457e62567d1f0b567e3}{LD\_WORD}(p);
806 
807     \textcolor{keywordflow}{case} \hyperlink{pff_8h_ac63e0796095a789cefdbc3c3c676c9ce}{FS\_FAT32}:
808         \textcolor{keywordflow}{if} (move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (clst / (\hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs) / 4))))
809             \textcolor{keywordflow}{break};
810         p = &fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[clst * 4 % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
811         \textcolor{keywordflow}{return} \hyperlink{pff_8h_a4690304ddc975516f7dc02575c96e34e}{LD\_DWORD}(p) & 0x0FFFFFFF;
812     \}
813 
814     \textcolor{keywordflow}{return} 0xFFFFFFFF; \textcolor{comment}{/* An error occurred at the disk I/O layer */}
815 \}
\end{DoxyCode}
\hypertarget{ff_8c_abd4b6b071a8d728a88727051c12bc6d7}{\index{ff.\-c@{ff.\-c}!put\-\_\-fat@{put\-\_\-fat}}
\index{put\-\_\-fat@{put\-\_\-fat}!ff.c@{ff.\-c}}
\subsubsection[{put\-\_\-fat}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} put\-\_\-fat (
\begin{DoxyParamCaption}
\item[{{\bf F\-A\-T\-F\-S} $\ast$}]{fs, }
\item[{{\bf D\-W\-O\-R\-D}}]{clst, }
\item[{{\bf D\-W\-O\-R\-D}}]{val}
\end{DoxyParamCaption}
)}}\label{ff_8c_abd4b6b071a8d728a88727051c12bc6d7}


Definition at line 822 of file ff.\-c.



References F\-A\-T\-F\-S\-::fatbase, F\-R\-\_\-\-I\-N\-T\-\_\-\-E\-R\-R, F\-R\-\_\-\-O\-K, F\-S\-\_\-\-F\-A\-T12, F\-S\-\_\-\-F\-A\-T16, F\-S\-\_\-\-F\-A\-T32, F\-A\-T\-F\-S\-::fs\-\_\-type, L\-D\-\_\-\-D\-W\-O\-R\-D, F\-A\-T\-F\-S\-::n\-\_\-fatent, res, S\-S, S\-T\-\_\-\-D\-W\-O\-R\-D, S\-T\-\_\-\-W\-O\-R\-D, F\-A\-T\-F\-S\-::wflag, and F\-A\-T\-F\-S\-::win.



Referenced by f\-\_\-truncate().


\begin{DoxyCode}
825   \{
826     \hyperlink{p8_2pinguino_2libraries_2integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{UINT} bc;
827     \hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE} *p;
828     \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44c}{FRESULT} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
829 
830     \textcolor{keywordflow}{if} (clst < 2 || clst >= fs->\hyperlink{struct_f_a_t_f_s_a388eb0fa0f3f1449a6ab88c6674e16fc}{n\_fatent}) \{ \textcolor{comment}{/* Check range */}
831         res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
832 
833     \} \textcolor{keywordflow}{else} \{
834         \textcolor{keywordflow}{switch} (fs->\hyperlink{struct_f_a_t_f_s_aee58d0bf64f06146927e78ad026b06ac}{fs\_type}) \{
835         \textcolor{keywordflow}{case} \hyperlink{pff_8h_aab755aa1b4f81f4aabee4a5d4738cfb0}{FS\_FAT12}:
836             bc = clst;
837             bc += bc / 2;
838             res = move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (bc / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)));
839             \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
840                 \textcolor{keywordflow}{break};
841             p = &fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[bc % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
842             *p = (clst & 1) ? ((*p & 0x0F) | ((\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) val << 4))
843                     : (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) val;
844             bc++;
845             fs->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
846             res = move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (bc / \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)));
847             \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
848                 \textcolor{keywordflow}{break};
849             p = &fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[bc % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
850             *p = (clst & 1) ? (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) (val >> 4) : ((*p & 0xF0)
851                     | ((\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_aa1e36ce100a7ff1291e95b4515d42e65}{PF\_BYTE}) (val >> 8) & 0x0F));
852             \textcolor{keywordflow}{break};
853 
854         \textcolor{keywordflow}{case} \hyperlink{pff_8h_a7ef90a36d99edfc0138a2155a17a79b9}{FS\_FAT16}:
855             res = move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (clst / (\hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs) / 2)));
856             \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
857                 \textcolor{keywordflow}{break};
858             p = &fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[clst * 2 % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
859             \hyperlink{pff_8h_a95ceb4c25b216e71baa7102939edfd0d}{ST\_WORD}(p, (\hyperlink{p32_2include_2pinguino_2libraries_2sd_2integer_8h_a3f29df22680f9b74773a028915984992}{PF\_WORD})val)
860             ;
861             \textcolor{keywordflow}{break};
862 
863         \textcolor{keywordflow}{case} \hyperlink{pff_8h_ac63e0796095a789cefdbc3c3c676c9ce}{FS\_FAT32}:
864             res = move\_window(fs, fs->\hyperlink{struct_f_a_t_f_s_a4c158f002bd87f70c1595baef8888d96}{fatbase} + (clst / (\hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs) / 4)));
865             \textcolor{keywordflow}{if} (res != \hyperlink{pff_8h_a49d0171ecbd362cda5680a0d360db44ca62fce5cd9df008f8fc85f99706bda5f1}{FR\_OK})
866                 \textcolor{keywordflow}{break};
867             p = &fs->\hyperlink{struct_f_a_t_f_s_a54541860d8273ee2709def80ccc3e271}{win}[clst * 4 % \hyperlink{ff_8c_a42b5140fc5e09a53c8f4cba66dc0e6c1}{SS}(fs)];
868             val |= \hyperlink{pff_8h_a4690304ddc975516f7dc02575c96e34e}{LD\_DWORD}(p) & 0xF0000000;
869             \hyperlink{pff_8h_abf5aba973d95ac5843b80aa7379cdd66}{ST\_DWORD}(p, val)
870             ;
871             \textcolor{keywordflow}{break};
872 
873         \textcolor{keywordflow}{default}:
874             res = \hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44cab6c9903af6e9bffbb7a288705f4a6a76}{FR\_INT\_ERR};
875         \}
876         fs->\hyperlink{struct_f_a_t_f_s_a34eeef694e75229e1608f07acba3ed1c}{wflag} = 1;
877     \}
878 
879     \textcolor{keywordflow}{return} \hyperlink{tff_8c_aab43d7bcfb87e7ef71138d651ce1bea1}{res};
880 \}
\end{DoxyCode}
